<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
    <meta name="theme-color" content="#DC2626">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="default">
    <meta name="apple-mobile-web-app-title" content="Bravari Burger">
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="format-detection" content="telephone=no">
    <title>Bravari Burger - Card√°pio Digital</title>
    
    <!-- Favicon -->
    <link rel="icon" type="image/png" href="https://github.com/bravariburger/pedir/blob/main/MYSTIC.png?raw=true">
    <link rel="shortcut icon" type="image/png" href="https://github.com/bravariburger/pedir/blob/main/MYSTIC.png?raw=true">
    <link rel="apple-touch-icon" href="https://github.com/bravariburger/pedir/blob/main/MYSTIC.png?raw=true">
    <link rel="apple-touch-icon" sizes="152x152" href="https://github.com/bravariburger/pedir/blob/main/MYSTIC.png?raw=true">
    <link rel="apple-touch-icon" sizes="180x180" href="https://github.com/bravariburger/pedir/blob/main/MYSTIC.png?raw=true">
    <link rel="apple-touch-icon" sizes="167x167" href="https://github.com/bravariburger/pedir/blob/main/MYSTIC.png?raw=true">
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        'brand-red': '#DC2626',
                        'brand-yellow': '#FCD34D',
                    }
                }
            }
        }
    </script>
    <style>
        /* Advanced Performance Optimizations */
        * {
            -webkit-tap-highlight-color: transparent;
            -webkit-touch-callout: none;
            -webkit-user-select: none;
            -moz-user-select: none;
            -ms-user-select: none;
            user-select: none;
        }
        
        input, textarea, select {
            -webkit-user-select: text;
            -moz-user-select: text;
            -ms-user-select: text;
            user-select: text;
        }
        
        body {
            -webkit-font-smoothing: antialiased;
            -moz-osx-font-smoothing: grayscale;
            text-rendering: optimizeLegibility;
            font-display: swap;
            overscroll-behavior: none;
            -webkit-overflow-scrolling: touch;
        }
        
        /* GPU Acceleration for smooth animations */
        .product-card, .modal-enter, button, .floating-cart {
            will-change: transform;
            transform: translateZ(0);
            backface-visibility: hidden;
            -webkit-backface-visibility: hidden;
        }
        
        /* Optimized scrolling */
        .scrollbar-hide {
            -ms-overflow-style: none;
            scrollbar-width: none;
            scroll-behavior: smooth;
            -webkit-overflow-scrolling: touch;
        }
        .scrollbar-hide::-webkit-scrollbar {
            display: none;
        }
        
        /* Enhanced animations with hardware acceleration */
        .modal-enter {
            animation: modalEnter 0.25s cubic-bezier(0.4, 0, 0.2, 1);
        }
        
        @keyframes modalEnter {
            from {
                opacity: 0;
                transform: translate3d(0, 100%, 0) scale(0.95);
            }
            to {
                opacity: 1;
                transform: translate3d(0, 0, 0) scale(1);
            }
        }
        
        /* Micro-interactions */
        .product-card {
            transition: all 0.2s cubic-bezier(0.4, 0, 0.2, 1);
        }
        
        .product-card:hover {
            transform: translateY(-2px) scale(1.02);
            box-shadow: 0 8px 25px rgba(0,0,0,0.15);
        }
        
        .product-card:active {
            transform: translateY(0) scale(0.98);
            transition-duration: 0.1s;
        }
        
        /* Button interactions */
        button {
            transition: all 0.15s cubic-bezier(0.4, 0, 0.2, 1);
            transform: translateZ(0);
        }
        
        button:active {
            transform: scale(0.95) translateZ(0);
        }
        
        /* Loading states with skeleton */
        .loading {
            opacity: 0.7;
            pointer-events: none;
            position: relative;
        }
        
        .loading::after {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: linear-gradient(90deg, transparent, rgba(255,255,255,0.4), transparent);
            animation: shimmer 1.5s infinite;
        }
        
        @keyframes shimmer {
            0% { transform: translateX(-100%); }
            100% { transform: translateX(100%); }
        }
        
        /* Enhanced touch targets */
        button, .cursor-pointer, input, select, textarea {
            min-height: 44px;
            min-width: 44px;
        }
        
        /* iOS specific optimizations */
        input, textarea, select {
            font-size: 16px;
            -webkit-appearance: none;
            border-radius: 8px;
        }
        
        /* Safe area enhancements */
        @supports (padding: max(0px)) {
            .safe-top {
                padding-top: max(1rem, env(safe-area-inset-top));
            }
            .safe-bottom {
                padding-bottom: max(1rem, env(safe-area-inset-bottom));
            }
            .safe-left {
                padding-left: max(1rem, env(safe-area-inset-left));
            }
            .safe-right {
                padding-right: max(1rem, env(safe-area-inset-right));
            }
        }
        
        /* Advanced image optimization */
        img {
            loading: lazy;
            decoding: async;
            content-visibility: auto;
            contain-intrinsic-size: 200px 128px;
        }
        
        /* Intersection Observer optimization */
        .lazy-load {
            opacity: 0;
            transition: opacity 0.3s ease-in-out;
        }
        
        .lazy-load.loaded {
            opacity: 1;
        }
        
        /* Critical rendering path optimization */
        .above-fold {
            content-visibility: visible;
        }
        
        .below-fold {
            content-visibility: auto;
            contain-intrinsic-size: 300px;
        }
        
        /* Network-aware loading */
        @media (prefers-reduced-motion: reduce) {
            *, *::before, *::after {
                animation-duration: 0.01ms !important;
                animation-iteration-count: 1 !important;
                transition-duration: 0.01ms !important;
            }
        }
        
        /* Dark mode support */
        @media (prefers-color-scheme: dark) {
            .auto-dark {
                filter: brightness(0.8);
            }
        }
        
        /* High contrast mode */
        @media (prefers-contrast: high) {
            .product-card {
                border: 2px solid;
            }
        }
        
        /* Focus management */
        .focus-trap {
            position: fixed;
            top: 0;
            left: 0;
            width: 1px;
            height: 1px;
            opacity: 0;
            pointer-events: none;
        }
        
        /* Enhanced error states */
        .error-shake {
            animation: shake 0.5s ease-in-out;
        }
        
        @keyframes shake {
            0%, 100% { transform: translateX(0); }
            25% { transform: translateX(-5px); }
            75% { transform: translateX(5px); }
        }
        
        /* Progressive enhancement */
        .no-js .js-only {
            display: none !important;
        }
        
        /* Memory optimization */
        .offscreen {
            content-visibility: hidden;
        }
        
        /* Reduced data mode */
        @media (prefers-reduced-data: reduce) {
            img {
                display: none;
            }
            .no-image {
                display: flex !important;
            }
        }
        
        /* Screen reader only content */
        .sr-only {
            position: absolute;
            width: 1px;
            height: 1px;
            padding: 0;
            margin: -1px;
            overflow: hidden;
            clip: rect(0, 0, 0, 0);
            white-space: nowrap;
            border: 0;
        }
        
        /* Mobile modal centering fixes */
        @media (max-width: 768px) {
            .modal-container {
                align-items: center !important;
                justify-content: center !important;
                padding: 1rem !important;
            }
            
            .modal-content {
                margin: 0 !important;
                max-height: 85vh !important;
                width: 100% !important;
                border-radius: 1rem !important;
            }
            
            /* Prevent viewport jumping on iOS */
            .modal-open {
                position: fixed;
                width: 100%;
                height: 100%;
                overflow: hidden;
            }
        }
        
        /* Floating button positioning fix */
        .floating-cart-fixed {
            position: fixed !important;
            bottom: 1rem !important;
            left: 1rem !important;
            right: 1rem !important;
            z-index: 50 !important;
            transform: translateZ(0) !important;
            -webkit-transform: translateZ(0) !important;
        }
        
        @supports (padding: max(0px)) {
            .floating-cart-fixed {
                bottom: max(1rem, env(safe-area-inset-bottom)) !important;
            }
        }
        
        /* Prevent button from moving on mobile scroll */
        @media (max-width: 768px) {
            .floating-cart-fixed {
                position: fixed !important;
                bottom: 1rem !important;
                transform: translate3d(0, 0, 0) !important;
                -webkit-transform: translate3d(0, 0, 0) !important;
                will-change: auto !important;
            }
        }
        
        /* High contrast mode enhancements */
        .high-contrast .product-card {
            border: 3px solid !important;
        }
        
        .high-contrast button {
            border: 2px solid !important;
        }
        
        /* Reduced motion mode */
        .reduced-motion * {
            animation-duration: 0.01ms !important;
            animation-iteration-count: 1 !important;
            transition-duration: 0.01ms !important;
        }
        
        /* Anima√ß√£o para chamar aten√ß√£o no t√≠tulo do troco */
        .attention-pulse {
            animation: attentionPulse 1.5s ease-in-out 3;
        }
        
        @keyframes attentionPulse {
            0% { 
                transform: scale(1);
                color: inherit;
            }
            50% { 
                transform: scale(1.05);
                color: #DC2626;
                text-shadow: 0 0 10px rgba(220, 38, 38, 0.3);
            }
            100% { 
                transform: scale(1);
                color: inherit;
            }
        }
    </style>
</head>
<body class="bg-gray-50">
    <!-- Header -->
    <header class="bg-brand-red text-white safe-top fixed top-0 left-0 right-0 z-40 shadow-lg">
        <div class="max-w-4xl mx-auto flex items-center justify-between p-4">
            <div class="flex items-center space-x-3">
                <img src="https://github.com/bravariburger/pedir/blob/main/MYSTIC.png?raw=true" 
                     alt="Bravari Burger" 
                     class="h-10 w-10 rounded-full flex-shrink-0"
                     loading="eager"
                     onerror="this.src=''; this.alt='Logo'; this.style.display='none';">
                <h1 class="text-xl font-bold truncate">Bravari Burger</h1>
            </div>
            <div class="text-sm flex-shrink-0">
                <p>Delivery</p>
            </div>
        </div>
    </header>

    <!-- Categories Navigation -->
    <nav class="bg-white shadow-sm fixed left-0 right-0 z-30 p-4" style="top: calc(4rem + env(safe-area-inset-top, 0px));">
        <div class="max-w-4xl mx-auto">
            <div class="flex space-x-3 overflow-x-auto scrollbar-hide pb-1" style="scroll-snap-type: x mandatory;">
                <button onclick="scrollToCategory('burgers')" class="category-btn bg-brand-red text-white px-4 py-2 rounded-full whitespace-nowrap flex-shrink-0 transition-all duration-200" style="scroll-snap-align: start;">
                    üçî Burgers
                </button>
                <button onclick="scrollToCategory('sobremesas')" class="category-btn bg-gray-200 text-gray-700 px-4 py-2 rounded-full whitespace-nowrap flex-shrink-0 transition-all duration-200" style="scroll-snap-align: start;">
                    üç´ Sobremesas
                </button>
                <button onclick="scrollToCategory('acompanhamentos')" class="category-btn bg-gray-200 text-gray-700 px-4 py-2 rounded-full whitespace-nowrap flex-shrink-0 transition-all duration-200" style="scroll-snap-align: start;">
                    üçü Acompanhamentos
                </button>
                <button onclick="scrollToCategory('bebidas')" class="category-btn bg-gray-200 text-gray-700 px-4 py-2 rounded-full whitespace-nowrap flex-shrink-0 transition-all duration-200" style="scroll-snap-align: start;">
                    ü•§ Bebidas
                </button>
                <button onclick="scrollToCategory('combos')" class="category-btn bg-gray-200 text-gray-700 px-4 py-2 rounded-full whitespace-nowrap flex-shrink-0 transition-all duration-200" style="scroll-snap-align: start;">
                    üçî Combos
                </button>
            </div>
        </div>
    </nav>

    <!-- Main Content -->
    <main class="max-w-4xl mx-auto p-4 pb-24 safe-bottom" style="padding-top: calc(8rem + env(safe-area-inset-top, 0px));">
        <!-- Burgers Category -->
        <section id="burgers" class="mb-8">
            <h2 class="text-2xl font-bold text-gray-800 mb-4 flex items-center">
                üçî Burgers
            </h2>
            <div class="grid grid-cols-2 gap-3 md:gap-4">
                <div class="product-card bg-white rounded-lg shadow-md overflow-hidden cursor-pointer transform transition-all duration-200 hover:scale-105 active:scale-95" onclick="openProductModal('cheddar-burger-1')" role="button" tabindex="0" onkeydown="if(event.key==='Enter'||event.key===' ')openProductModal('cheddar-burger-1')">
                    <div class="relative">
                        <img src="https://github.com/bravariburger/inaugura-o/blob/main/burguers%20JPG/1.jpg?raw=true" 
                             alt="Cheddar Burguer" 
                             class="w-full h-32 object-cover"
                             loading="lazy"
                             style="image-rendering: -webkit-optimize-contrast; image-rendering: crisp-edges;"
                             onerror="this.style.display='none'; this.parentElement.querySelector('.no-image').style.display='flex';">
                        <div class="no-image hidden bg-gray-200 h-32 items-center justify-center">
                            <span class="text-gray-500">üì∑ Adicionar Foto</span>
                        </div>
                    </div>
                    <div class="p-4">
                        <h3 class="font-semibold text-gray-800 line-clamp-1">üçî Cheddar Burguer</h3>
                        <p class="text-sm text-gray-600 mt-1 line-clamp-2">Delicioso burger com queijo cheddar</p>
                        <p class="text-brand-red font-bold mt-2">R$ 16,90</p>
                    </div>
                </div>

                <div class="product-card bg-white rounded-lg shadow-md overflow-hidden cursor-pointer" onclick="openProductModal('cheddar-bacon-burger-2')">
                    <img src="https://github.com/bravariburger/inaugura-o/blob/main/burguers%20JPG/2.jpg?raw=true" 
                         alt="Cheddar Bacon Burguer" 
                         class="w-full h-32 object-cover"
                         onerror="this.src=''; this.parentElement.querySelector('.no-image').style.display='flex';">
                    <div class="no-image hidden bg-gray-200 h-32 items-center justify-center">
                        <span class="text-gray-500">üì∑ Adicionar Foto</span>
                    </div>
                    <div class="p-4">
                        <h3 class="font-semibold text-gray-800">üçî Cheddar Bacon Burguer</h3>
                        <p class="text-sm text-gray-600 mt-1">Burger com cheddar e bacon crocante</p>
                        <p class="text-brand-red font-bold mt-2">R$ 19,90</p>
                    </div>
                </div>

                <div class="product-card bg-white rounded-lg shadow-md overflow-hidden cursor-pointer" onclick="openProductModal('bravari-burger-3')">
                    <img src="https://github.com/bravariburger/inaugura-o/blob/main/burguers%20JPG/3.jpg?raw=true" 
                         alt="Bravari Burguer" 
                         class="w-full h-32 object-cover"
                         onerror="this.src=''; this.parentElement.querySelector('.no-image').style.display='flex';">
                    <div class="no-image hidden bg-gray-200 h-32 items-center justify-center">
                        <span class="text-gray-500">üì∑ Adicionar Foto</span>
                    </div>
                    <div class="p-4">
                        <h3 class="font-semibold text-gray-800">üçî Bravari Burguer</h3>
                        <p class="text-sm text-gray-600 mt-1">Nosso burger especial da casa</p>
                        <p class="text-brand-red font-bold mt-2">R$ 23,90</p>
                    </div>
                </div>

                <div class="product-card bg-white rounded-lg shadow-md overflow-hidden cursor-pointer" onclick="openProductModal('cheddar-duplo-4')">
                    <img src="https://github.com/bravariburger/inaugura-o/blob/main/burguers%20JPG/4.jpg?raw=true" 
                         alt="Cheddar Burguer Duplo" 
                         class="w-full h-32 object-cover"
                         onerror="this.src=''; this.parentElement.querySelector('.no-image').style.display='flex';">
                    <div class="no-image hidden bg-gray-200 h-32 items-center justify-center">
                        <span class="text-gray-500">üì∑ Adicionar Foto</span>
                    </div>
                    <div class="p-4">
                        <h3 class="font-semibold text-gray-800">üçî Cheddar Burguer Duplo</h3>
                        <p class="text-sm text-gray-600 mt-1">Dupla dose de sabor com cheddar</p>
                        <p class="text-brand-red font-bold mt-2">R$ 29,90</p>
                    </div>
                </div>

                <div class="product-card bg-white rounded-lg shadow-md overflow-hidden cursor-pointer" onclick="openProductModal('cheddar-bacon-duplo-5')">
                    <img src="https://github.com/bravariburger/inaugura-o/blob/main/burguers%20JPG/5.jpg?raw=true" 
                         alt="Cheddar Bacon Burguer Duplo" 
                         class="w-full h-32 object-cover"
                         onerror="this.src=''; this.parentElement.querySelector('.no-image').style.display='flex';">
                    <div class="no-image hidden bg-gray-200 h-32 items-center justify-center">
                        <span class="text-gray-500">üì∑ Adicionar Foto</span>
                    </div>
                    <div class="p-4">
                        <h3 class="font-semibold text-gray-800">üçî Cheddar Bacon Burguer Duplo</h3>
                        <p class="text-sm text-gray-600 mt-1">Duplo prazer com cheddar e bacon</p>
                        <p class="text-brand-red font-bold mt-2">R$ 32,90</p>
                    </div>
                </div>

                <div class="product-card bg-white rounded-lg shadow-md overflow-hidden cursor-pointer" onclick="openProductModal('bravari-duplo-6')">
                    <img src="https://github.com/bravariburger/inaugura-o/blob/main/burguers%20JPG/6.jpg?raw=true" 
                         alt="Bravari Burguer Duplo" 
                         class="w-full h-32 object-cover"
                         onerror="this.src=''; this.parentElement.querySelector('.no-image').style.display='flex';">
                    <div class="no-image hidden bg-gray-200 h-32 items-center justify-center">
                        <span class="text-gray-500">üì∑ Adicionar Foto</span>
                    </div>
                    <div class="p-4">
                        <h3 class="font-semibold text-gray-800">üçî Bravari Burguer Duplo</h3>
                        <p class="text-sm text-gray-600 mt-1">Vers√£o dupla do nosso especial</p>
                        <p class="text-brand-red font-bold mt-2">R$ 32,90</p>
                    </div>
                </div>

                <div class="product-card bg-white rounded-lg shadow-md overflow-hidden cursor-pointer" onclick="openProductModal('bravari-bacon-triplo-7')">
                    <img src="https://github.com/bravariburger/inaugura-o/blob/main/burguers%20JPG/7.jpg?raw=true" 
                         alt="Bravari Bacon Triplo" 
                         class="w-full h-32 object-cover"
                         onerror="this.src=''; this.parentElement.querySelector('.no-image').style.display='flex';">
                    <div class="no-image hidden bg-gray-200 h-32 items-center justify-center">
                        <span class="text-gray-500">üì∑ Adicionar Foto</span>
                    </div>
                    <div class="p-4">
                        <h3 class="font-semibold text-gray-800">üçî Bravari Bacon Triplo</h3>
                        <p class="text-sm text-gray-600 mt-1">Tripla dose de sabor com bacon</p>
                        <p class="text-brand-red font-bold mt-2">R$ 43,90</p>
                    </div>
                </div>

                <div class="product-card bg-white rounded-lg shadow-md overflow-hidden cursor-pointer" onclick="openProductModal('bravari-ring-triplo-8')">
                    <img src="https://github.com/bravariburger/inaugura-o/blob/main/burguers%20JPG/8.jpg?raw=true" 
                         alt="Bravari Ring Triplo" 
                         class="w-full h-32 object-cover"
                         onerror="this.src=''; this.parentElement.querySelector('.no-image').style.display='flex';">
                    <div class="no-image hidden bg-gray-200 h-32 items-center justify-center">
                        <span class="text-gray-500">üì∑ Adicionar Foto</span>
                    </div>
                    <div class="p-4">
                        <h3 class="font-semibold text-gray-800">üçî Bravari Ring Triplo</h3>
                        <p class="text-sm text-gray-600 mt-1">Triplo burger com onion rings</p>
                        <p class="text-brand-red font-bold mt-2">R$ 43,90</p>
                    </div>
                </div>

                <div class="product-card bg-white rounded-lg shadow-md overflow-hidden cursor-pointer" onclick="openProductModal('bravari-ring-9')">
                    <img src="https://github.com/bravariburger/inaugura-o/blob/main/burguers%20JPG/9.jpg?raw=true" 
                         alt="Bravari Burguer Ring" 
                         class="w-full h-32 object-cover"
                         onerror="this.src=''; this.parentElement.querySelector('.no-image').style.display='flex';">
                    <div class="no-image hidden bg-gray-200 h-32 items-center justify-center">
                        <span class="text-gray-500">üì∑ Adicionar Foto</span>
                    </div>
                    <div class="p-4">
                        <h3 class="font-semibold text-gray-800">üçî Bravari Burguer Ring</h3>
                        <p class="text-sm text-gray-600 mt-1">Burger especial com onion rings</p>
                        <p class="text-brand-red font-bold mt-2">R$ 35,90</p>
                    </div>
                </div>

                <div class="product-card bg-white rounded-lg shadow-md overflow-hidden cursor-pointer" onclick="openProductModal('vulcan-burger-10')">
                    <img src="https://github.com/bravariburger/inaugura-o/blob/main/burguers%20JPG/10.jpg?raw=true" 
                         alt="Vulcan Burguer" 
                         class="w-full h-32 object-cover"
                         onerror="this.src=''; this.parentElement.querySelector('.no-image').style.display='flex';">
                    <div class="no-image hidden bg-gray-200 h-32 items-center justify-center">
                        <span class="text-gray-500">üì∑ Adicionar Foto</span>
                    </div>
                    <div class="p-4">
                        <h3 class="font-semibold text-gray-800">üçî Vulcan Burguer</h3>
                        <p class="text-sm text-gray-600 mt-1">Burger picante para os corajosos</p>
                        <p class="text-brand-red font-bold mt-2">R$ 39,90</p>
                    </div>
                </div>

                <div class="product-card bg-white rounded-lg shadow-md overflow-hidden cursor-pointer" onclick="openProductModal('cream-cheese-11')">
                    <img src="https://github.com/bravariburger/inaugura-o/blob/main/burguers%20JPG/11.jpg?raw=true" 
                         alt="Cream Cheese Burguer" 
                         class="w-full h-32 object-cover"
                         onerror="this.src=''; this.parentElement.querySelector('.no-image').style.display='flex';">
                    <div class="no-image hidden bg-gray-200 h-32 items-center justify-center">
                        <span class="text-gray-500">üì∑ Adicionar Foto</span>
                    </div>
                    <div class="p-4">
                        <h3 class="font-semibold text-gray-800">üçî Cream Cheese Burguer</h3>
                        <p class="text-sm text-gray-600 mt-1">Burger cremoso com cream cheese</p>
                        <p class="text-brand-red font-bold mt-2">R$ 26,90</p>
                    </div>
                </div>

                <div class="product-card bg-white rounded-lg shadow-md overflow-hidden cursor-pointer" onclick="openProductModal('bravari-salada-12')">
                    <img src="https://github.com/bravariburger/inaugura-o/blob/main/burguers%20JPG/salada.jpg?raw=true" 
                         alt="Bravari Salada" 
                         class="w-full h-32 object-cover"
                         onerror="this.src=''; this.parentElement.querySelector('.no-image').style.display='flex';">
                    <div class="no-image hidden bg-gray-200 h-32 items-center justify-center">
                        <span class="text-gray-500">üì∑ Adicionar Foto</span>
                    </div>
                    <div class="p-4">
                        <h3 class="font-semibold text-gray-800">üçî Bravari Salada</h3>
                        <p class="text-sm text-gray-600 mt-1">Op√ß√£o saud√°vel com salada fresca</p>
                        <p class="text-brand-red font-bold mt-2">R$ 19,90</p>
                    </div>
                </div>

                <div class="product-card bg-white rounded-lg shadow-md overflow-hidden cursor-pointer" onclick="openProductModal('cheddar-triplo-13')">
                    <img src="https://github.com/bravariburger/inaugura-o/blob/main/burguers%20JPG/12.jpg?raw=true" 
                         alt="Cheddar Burguer Triplo" 
                         class="w-full h-32 object-cover"
                         onerror="this.src=''; this.parentElement.querySelector('.no-image').style.display='flex';">
                    <div class="no-image hidden bg-gray-200 h-32 items-center justify-center">
                        <span class="text-gray-500">üì∑ Adicionar Foto</span>
                    </div>
                    <div class="p-4">
                        <h3 class="font-semibold text-gray-800">üçî Cheddar Burguer Triplo</h3>
                        <p class="text-sm text-gray-600 mt-1">Tripla dose de cheddar cremoso</p>
                        <p class="text-brand-red font-bold mt-2">R$ 39,90</p>
                    </div>
                </div>
            </div>
        </section>

        <!-- Sobremesas Category -->
        <section id="sobremesas" class="mb-8">
            <h2 class="text-2xl font-bold text-gray-800 mb-4 flex items-center">
                üç´ Sobremesas
            </h2>
            
            <!-- Carousel Container -->
            <div class="relative">
                <div id="sobremesas-carousel" class="flex overflow-x-auto scrollbar-hide space-x-4 pb-4">
                    <div class="product-card bg-white rounded-lg shadow-md overflow-hidden cursor-pointer flex-shrink-0 w-64" onclick="openProductModal('brownie-chocolate')">
                        <img src="https://github.com/bravariburger/pedir/blob/main/Sobremesas/brownie.jpg?raw=true" 
                             alt="Brownie Chocolate" 
                             class="w-full h-32 object-cover"
                             onerror="this.src=''; this.parentElement.querySelector('.no-image').style.display='flex';">
                        <div class="no-image hidden bg-gray-200 h-32 items-center justify-center">
                            <span class="text-gray-500">üì∑ Adicionar Foto</span>
                        </div>
                        <div class="p-4">
                            <h3 class="font-semibold text-gray-800">Brownie Chocolate</h3>
                            <p class="text-sm text-gray-600 mt-1">Brownie cremoso de chocolate</p>
                            <p class="text-brand-red font-bold mt-2">R$ 9,90</p>
                        </div>
                    </div>

                    <div class="product-card bg-white rounded-lg shadow-md overflow-hidden cursor-pointer flex-shrink-0 w-64" onclick="openProductModal('brownie-branco')">
                        <img src="https://github.com/bravariburger/pedir/blob/main/Sobremesas/brownie.jpg?raw=true" 
                             alt="Brownie Chocolate Branco" 
                             class="w-full h-32 object-cover"
                             onerror="this.src=''; this.parentElement.querySelector('.no-image').style.display='flex';">
                        <div class="no-image hidden bg-gray-200 h-32 items-center justify-center">
                            <span class="text-gray-500">üì∑ Adicionar Foto</span>
                        </div>
                        <div class="p-4">
                            <h3 class="font-semibold text-gray-800">Brownie Chocolate Branco</h3>
                            <p class="text-sm text-gray-600 mt-1">Brownie de chocolate branco</p>
                            <p class="text-brand-red font-bold mt-2">R$ 9,90</p>
                        </div>
                    </div>

                    <div class="product-card bg-white rounded-lg shadow-md overflow-hidden cursor-pointer flex-shrink-0 w-64" onclick="openProductModal('brownie-nutella')">
                        <div class="no-image bg-gray-200 h-32 flex items-center justify-center">
                            <span class="text-gray-500">üì∑ Adicionar Foto</span>
                        </div>
                        <div class="p-4">
                            <h3 class="font-semibold text-gray-800">Brownie Nutella</h3>
                            <p class="text-sm text-gray-600 mt-1">Brownie com recheio de Nutella</p>
                            <p class="text-brand-red font-bold mt-2">R$ 16,90</p>
                        </div>
                    </div>

                    <div class="product-card bg-white rounded-lg shadow-md overflow-hidden cursor-pointer flex-shrink-0 w-64" onclick="openProductModal('brownie-morango')">
                        <div class="no-image bg-gray-200 h-32 flex items-center justify-center">
                            <span class="text-gray-500">üì∑ Adicionar Foto</span>
                        </div>
                        <div class="p-4">
                            <h3 class="font-semibold text-gray-800">Brownie Morango</h3>
                            <p class="text-sm text-gray-600 mt-1">Brownie com cobertura de morango</p>
                            <p class="text-brand-red font-bold mt-2">R$ 16,90</p>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- Acompanhamentos Category -->
        <section id="acompanhamentos" class="mb-8">
            <h2 class="text-2xl font-bold text-gray-800 mb-4 flex items-center">
                üçü Acompanhamentos
            </h2>
            <div class="grid grid-cols-2 gap-3 md:gap-4">
                <div class="product-card bg-white rounded-lg shadow-md overflow-hidden cursor-pointer" onclick="openProductModal('batata-p')">
                    <img src="https://github.com/bravariburger/pedir/blob/main/Batatas/batata%20frita.jpg?raw=true" 
                         alt="Batata Frita P" 
                         class="w-full h-32 object-cover"
                         onerror="this.src=''; this.parentElement.querySelector('.no-image').style.display='flex';">
                    <div class="no-image hidden bg-gray-200 h-32 items-center justify-center">
                        <span class="text-gray-500">üì∑ Adicionar Foto</span>
                    </div>
                    <div class="p-4">
                        <h3 class="font-semibold text-gray-800">üçü Batata Frita P</h3>
                        <p class="text-sm text-gray-600 mt-1">Por√ß√£o pequena de batata frita</p>
                        <p class="text-brand-red font-bold mt-2">R$ 13,90</p>
                    </div>
                </div>

                <div class="product-card bg-white rounded-lg shadow-md overflow-hidden cursor-pointer" onclick="openProductModal('batata-m')">
                    <img src="https://github.com/bravariburger/pedir/blob/main/Batatas/batata%20frita.jpg?raw=true" 
                         alt="Batata Frita M" 
                         class="w-full h-32 object-cover"
                         onerror="this.src=''; this.parentElement.querySelector('.no-image').style.display='flex';">
                    <div class="no-image hidden bg-gray-200 h-32 items-center justify-center">
                        <span class="text-gray-500">üì∑ Adicionar Foto</span>
                    </div>
                    <div class="p-4">
                        <h3 class="font-semibold text-gray-800">üçü Batata Frita M</h3>
                        <p class="text-sm text-gray-600 mt-1">Por√ß√£o m√©dia de batata frita</p>
                        <p class="text-brand-red font-bold mt-2">R$ 21,90</p>
                    </div>
                </div>

                <div class="product-card bg-white rounded-lg shadow-md overflow-hidden cursor-pointer" onclick="openProductModal('batata-g')">
                    <img src="https://github.com/bravariburger/pedir/blob/main/Batatas/batata%20frita.jpg?raw=true" 
                         alt="Batata Frita G" 
                         class="w-full h-32 object-cover"
                         onerror="this.src=''; this.parentElement.querySelector('.no-image').style.display='flex';">
                    <div class="no-image hidden bg-gray-200 h-32 items-center justify-center">
                        <span class="text-gray-500">üì∑ Adicionar Foto</span>
                    </div>
                    <div class="p-4">
                        <h3 class="font-semibold text-gray-800">üçü Batata Frita G</h3>
                        <p class="text-sm text-gray-600 mt-1">Por√ß√£o grande de batata frita</p>
                        <p class="text-brand-red font-bold mt-2">R$ 29,90</p>
                    </div>
                </div>
            </div>
        </section>

        <!-- Bebidas Category -->
        <section id="bebidas" class="mb-8">
            <h2 class="text-2xl font-bold text-gray-800 mb-4 flex items-center">
                ü•§ Bebidas
            </h2>
            <div class="grid grid-cols-2 gap-3 md:gap-4">
                <div class="product-card bg-white rounded-lg shadow-md overflow-hidden cursor-pointer" onclick="openProductModal('coca-cola')">
                    <img src="https://github.com/bravariburger/pedir/blob/main/Bebidas/coca.jpg?raw=true" 
                         alt="Coca Cola 350ml" 
                         class="w-full h-32 object-cover"
                         onerror="this.src=''; this.parentElement.querySelector('.no-image').style.display='flex';">
                    <div class="no-image hidden bg-gray-200 h-32 items-center justify-center">
                        <span class="text-gray-500">üì∑ Adicionar Foto</span>
                    </div>
                    <div class="p-4">
                        <h3 class="font-semibold text-gray-800">Coca Cola 350ml</h3>
                        <p class="text-sm text-gray-600 mt-1">Refrigerante Coca Cola</p>
                        <p class="text-brand-red font-bold mt-2">R$ 7,00</p>
                    </div>
                </div>

                <div class="product-card bg-white rounded-lg shadow-md overflow-hidden cursor-pointer" onclick="openProductModal('coca-zero')">
                    <img src="https://github.com/bravariburger/pedir/blob/main/Bebidas/coca%20zero.jpg?raw=true" 
                         alt="Coca Cola Zero" 
                         class="w-full h-32 object-cover"
                         onerror="this.src=''; this.parentElement.querySelector('.no-image').style.display='flex';">
                    <div class="no-image hidden bg-gray-200 h-32 items-center justify-center">
                        <span class="text-gray-500">üì∑ Adicionar Foto</span>
                    </div>
                    <div class="p-4">
                        <h3 class="font-semibold text-gray-800">Coca Cola Zero 350ml</h3>
                        <p class="text-sm text-gray-600 mt-1">Refrigerante Coca Cola Zero</p>
                        <p class="text-brand-red font-bold mt-2">R$ 7,00</p>
                    </div>
                </div>

                <div class="product-card bg-white rounded-lg shadow-md overflow-hidden cursor-pointer" onclick="openProductModal('guarana-antartica')">
                    <img src="https://github.com/bravariburger/pedir/blob/main/Bebidas/giuarana%20antartica.jpg?raw=true" 
                         alt="Guaran√° Ant√°rtica" 
                         class="w-full h-32 object-cover"
                         onerror="this.src=''; this.parentElement.querySelector('.no-image').style.display='flex';">
                    <div class="no-image hidden bg-gray-200 h-32 items-center justify-center">
                        <span class="text-gray-500">üì∑ Adicionar Foto</span>
                    </div>
                    <div class="p-4">
                        <h3 class="font-semibold text-gray-800">Guaran√° Ant√°rtica 350ml</h3>
                        <p class="text-sm text-gray-600 mt-1">Refrigerante Guaran√° Ant√°rtica</p>
                        <p class="text-brand-red font-bold mt-2">R$ 7,00</p>
                    </div>
                </div>
            </div>
        </section>

        <!-- Combos Category -->
        <section id="combos" class="mb-8">
            <h2 class="text-2xl font-bold text-gray-800 mb-4 flex items-center">
                üçî Combos
            </h2>
            <div class="grid grid-cols-2 gap-3 md:gap-4">
                <div class="product-card bg-white rounded-lg shadow-md overflow-hidden cursor-pointer" onclick="openProductModal('combo-cheddar-1')">
                    <img src="https://github.com/bravariburger/inaugura-o/blob/main/combos%20JPG/1.jpg?raw=true" 
                         alt="Combo Cheddar Burguer" 
                         class="w-full h-32 object-cover"
                         onerror="this.src=''; this.parentElement.querySelector('.no-image').style.display='flex';">
                    <div class="no-image hidden bg-gray-200 h-32 items-center justify-center">
                        <span class="text-gray-500">üì∑ Adicionar Foto</span>
                    </div>
                    <div class="p-4">
                        <h3 class="font-semibold text-gray-800">üçî Combo Cheddar Burguer</h3>
                        <p class="text-sm text-gray-600 mt-1">Burger + Batata + Bebida</p>
                        <p class="text-brand-red font-bold mt-2">R$ 37,90</p>
                    </div>
                </div>

                <div class="product-card bg-white rounded-lg shadow-md overflow-hidden cursor-pointer" onclick="openProductModal('combo-cheddar-bacon-2')">
                    <img src="https://github.com/bravariburger/inaugura-o/blob/main/combos%20JPG/2.jpg?raw=true" 
                         alt="Combo Cheddar Bacon" 
                         class="w-full h-32 object-cover"
                         onerror="this.src=''; this.parentElement.querySelector('.no-image').style.display='flex';">
                    <div class="no-image hidden bg-gray-200 h-32 items-center justify-center">
                        <span class="text-gray-500">üì∑ Adicionar Foto</span>
                    </div>
                    <div class="p-4">
                        <h3 class="font-semibold text-gray-800">üçî Combo Cheddar Bacon Burguer</h3>
                        <p class="text-sm text-gray-600 mt-1">Burger + Batata + Bebida</p>
                        <p class="text-brand-red font-bold mt-2">R$ 40,90</p>
                    </div>
                </div>

                <div class="product-card bg-white rounded-lg shadow-md overflow-hidden cursor-pointer" onclick="openProductModal('combo-bravari-3')">
                    <img src="https://github.com/bravariburger/inaugura-o/blob/main/combos%20JPG/3.jpg?raw=true" 
                         alt="Combo Bravari Burguer" 
                         class="w-full h-32 object-cover"
                         onerror="this.src=''; this.parentElement.querySelector('.no-image').style.display='flex';">
                    <div class="no-image hidden bg-gray-200 h-32 items-center justify-center">
                        <span class="text-gray-500">üì∑ Adicionar Foto</span>
                    </div>
                    <div class="p-4">
                        <h3 class="font-semibold text-gray-800">üçî Combo Bravari Burguer</h3>
                        <p class="text-sm text-gray-600 mt-1">Burger + Batata + Bebida</p>
                        <p class="text-brand-red font-bold mt-2">R$ 42,90</p>
                    </div>
                </div>

                <div class="product-card bg-white rounded-lg shadow-md overflow-hidden cursor-pointer" onclick="openProductModal('combo-cheddar-duplo-4')">
                    <img src="https://github.com/bravariburger/pedir/blob/main/fotos%20dos%20combos%20-%20bravari%20burguer/Cheddar%20Burguer%20Duplo.jpg?raw=true" 
                         alt="Combo Cheddar Duplo" 
                         class="w-full h-32 object-cover"
                         onerror="this.src=''; this.parentElement.querySelector('.no-image').style.display='flex';">
                    <div class="no-image hidden bg-gray-200 h-32 items-center justify-center">
                        <span class="text-gray-500">üì∑ Adicionar Foto</span>
                    </div>
                    <div class="p-4">
                        <h3 class="font-semibold text-gray-800">üçî Combo Cheddar Burguer Duplo</h3>
                        <p class="text-sm text-gray-600 mt-1">Burger + Batata + Bebida</p>
                        <p class="text-brand-red font-bold mt-2">R$ 47,90</p>
                    </div>
                </div>

                <div class="product-card bg-white rounded-lg shadow-md overflow-hidden cursor-pointer" onclick="openProductModal('combo-cheddar-bacon-duplo-5')">
                    <img src="https://github.com/bravariburger/pedir/blob/main/fotos%20dos%20combos%20-%20bravari%20burguer/Cheddar%20Bacon%20Burguer%20Duplo.jpg?raw=true" 
                         alt="Combo Cheddar Bacon Duplo" 
                         class="w-full h-32 object-cover"
                         onerror="this.src=''; this.parentElement.querySelector('.no-image').style.display='flex';">
                    <div class="no-image hidden bg-gray-200 h-32 items-center justify-center">
                        <span class="text-gray-500">üì∑ Adicionar Foto</span>
                    </div>
                    <div class="p-4">
                        <h3 class="font-semibold text-gray-800">üçî Combo Cheddar Bacon Burguer Duplo</h3>
                        <p class="text-sm text-gray-600 mt-1">Burger + Batata + Bebida</p>
                        <p class="text-brand-red font-bold mt-2">R$ 49,90</p>
                    </div>
                </div>

                <div class="product-card bg-white rounded-lg shadow-md overflow-hidden cursor-pointer" onclick="openProductModal('combo-bravari-duplo-6')">
                    <img src="https://github.com/bravariburger/pedir/blob/main/fotos%20dos%20combos%20-%20bravari%20burguer/Bravari%20Burguer%20Duplo.jpg?raw=true" 
                         alt="Combo Bravari Duplo" 
                         class="w-full h-32 object-cover"
                         onerror="this.src=''; this.parentElement.querySelector('.no-image').style.display='flex';">
                    <div class="no-image hidden bg-gray-200 h-32 items-center justify-center">
                        <span class="text-gray-500">üì∑ Adicionar Foto</span>
                    </div>
                    <div class="p-4">
                        <h3 class="font-semibold text-gray-800">üçî Combo Bravari Burguer Duplo</h3>
                        <p class="text-sm text-gray-600 mt-1">Burger + Batata + Bebida</p>
                        <p class="text-brand-red font-bold mt-2">R$ 49,90</p>
                    </div>
                </div>

                <div class="product-card bg-white rounded-lg shadow-md overflow-hidden cursor-pointer" onclick="openProductModal('combo-bravari-bacon-triplo-7')">
                    <img src="https://github.com/bravariburger/pedir/blob/main/fotos%20dos%20combos%20-%20bravari%20burguer/Bravari%20Bacon%20Triplo.jpg?raw=true" 
                         alt="Combo Bravari Bacon Triplo" 
                         class="w-full h-32 object-cover"
                         onerror="this.src=''; this.parentElement.querySelector('.no-image').style.display='flex';">
                    <div class="no-image hidden bg-gray-200 h-32 items-center justify-center">
                        <span class="text-gray-500">üì∑ Adicionar Foto</span>
                    </div>
                    <div class="p-4">
                        <h3 class="font-semibold text-gray-800">üçî Combo Bravari Bacon Triplo</h3>
                        <p class="text-sm text-gray-600 mt-1">Burger + Batata + Bebida</p>
                        <p class="text-brand-red font-bold mt-2">R$ 59,90</p>
                    </div>
                </div>

                <div class="product-card bg-white rounded-lg shadow-md overflow-hidden cursor-pointer" onclick="openProductModal('combo-bravari-ring-triplo-8')">
                    <img src="https://github.com/bravariburger/pedir/blob/main/fotos%20dos%20combos%20-%20bravari%20burguer/Bravari%20Ring%20Triplo.jpg?raw=true" 
                         alt="Combo Bravari Ring Triplo" 
                         class="w-full h-32 object-cover"
                         onerror="this.src=''; this.parentElement.querySelector('.no-image').style.display='flex';">
                    <div class="no-image hidden bg-gray-200 h-32 items-center justify-center">
                        <span class="text-gray-500">üì∑ Adicionar Foto</span>
                    </div>
                    <div class="p-4">
                        <h3 class="font-semibold text-gray-800">üçî Combo Bravari Ring Triplo</h3>
                        <p class="text-sm text-gray-600 mt-1">Burger + Batata + Bebida</p>
                        <p class="text-brand-red font-bold mt-2">R$ 59,90</p>
                    </div>
                </div>

                <div class="product-card bg-white rounded-lg shadow-md overflow-hidden cursor-pointer" onclick="openProductModal('combo-bravari-ring-9')">
                    <img src="https://github.com/bravariburger/pedir/blob/main/fotos%20dos%20combos%20-%20bravari%20burguer/bravari%20burguer%20ring%20duplo.jpg?raw=true" 
                         alt="Combo Bravari Ring" 
                         class="w-full h-32 object-cover"
                         onerror="this.src=''; this.parentElement.querySelector('.no-image').style.display='flex';">
                    <div class="no-image hidden bg-gray-200 h-32 items-center justify-center">
                        <span class="text-gray-500">üì∑ Adicionar Foto</span>
                    </div>
                    <div class="p-4">
                        <h3 class="font-semibold text-gray-800">üçî Combo Bravari Burguer Ring</h3>
                        <p class="text-sm text-gray-600 mt-1">Burger + Batata + Bebida</p>
                        <p class="text-brand-red font-bold mt-2">R$ 53,90</p>
                    </div>
                </div>

                <div class="product-card bg-white rounded-lg shadow-md overflow-hidden cursor-pointer" onclick="openProductModal('combo-vulcan-10')">
                    <img src="https://github.com/bravariburger/pedir/blob/main/fotos%20dos%20combos%20-%20bravari%20burguer/bravari%20burguer%20ring%20duplo.jpg?raw=true" 
                         alt="Combo Vulcan" 
                         class="w-full h-32 object-cover"
                         onerror="this.src=''; this.parentElement.querySelector('.no-image').style.display='flex';">
                    <div class="no-image hidden bg-gray-200 h-32 items-center justify-center">
                        <span class="text-gray-500">üì∑ Adicionar Foto</span>
                    </div>
                    <div class="p-4">
                        <h3 class="font-semibold text-gray-800">üçî Combo Vulcan Burguer</h3>
                        <p class="text-sm text-gray-600 mt-1">Burger + Batata + Bebida</p>
                        <p class="text-brand-red font-bold mt-2">R$ 59,90</p>
                    </div>
                </div>

                <div class="product-card bg-white rounded-lg shadow-md overflow-hidden cursor-pointer" onclick="openProductModal('combo-cream-cheese-11')">
                    <img src="https://github.com/bravariburger/pedir/blob/main/fotos%20dos%20combos%20-%20bravari%20burguer/bravari%20burguer%20ring%20duplo.jpg?raw=true" 
                         alt="Combo Cream Cheese" 
                         class="w-full h-32 object-cover"
                         onerror="this.src=''; this.parentElement.querySelector('.no-image').style.display='flex';">
                    <div class="no-image hidden bg-gray-200 h-32 items-center justify-center">
                        <span class="text-gray-500">üì∑ Adicionar Foto</span>
                    </div>
                    <div class="p-4">
                        <h3 class="font-semibold text-gray-800">üçî Combo Cream Cheese Burguer</h3>
                        <p class="text-sm text-gray-600 mt-1">Burger + Batata + Bebida</p>
                        <p class="text-brand-red font-bold mt-2">R$ 45,90</p>
                    </div>
                </div>

                <div class="product-card bg-white rounded-lg shadow-md overflow-hidden cursor-pointer" onclick="openProductModal('combo-bravari-salada-12')">
                    <img src="https://github.com/bravariburger/pedir/blob/main/fotos%20dos%20combos%20-%20bravari%20burguer/Bravari%20Burguer.jpg?raw=true" 
                         alt="Combo Bravari Salada" 
                         class="w-full h-32 object-cover"
                         onerror="this.src=''; this.parentElement.querySelector('.no-image').style.display='flex';">
                    <div class="no-image hidden bg-gray-200 h-32 items-center justify-center">
                        <span class="text-gray-500">üì∑ Adicionar Foto</span>
                    </div>
                    <div class="p-4">
                        <h3 class="font-semibold text-gray-800">üçî Combo Bravari Salada</h3>
                        <p class="text-sm text-gray-600 mt-1">Burger + Batata + Bebida</p>
                        <p class="text-brand-red font-bold mt-2">R$ 37,90</p>
                    </div>
                </div>

                <div class="product-card bg-white rounded-lg shadow-md overflow-hidden cursor-pointer" onclick="openProductModal('combo-cheddar-triplo-13')">
                    <img src="https://github.com/bravariburger/inaugura-o/blob/main/combos%20JPG/7.jpg?raw=true" 
                         alt="Combo Cheddar Triplo" 
                         class="w-full h-32 object-cover"
                         onerror="this.src=''; this.parentElement.querySelector('.no-image').style.display='flex';">
                    <div class="no-image hidden bg-gray-200 h-32 items-center justify-center">
                        <span class="text-gray-500">üì∑ Adicionar Foto</span>
                    </div>
                    <div class="p-4">
                        <h3 class="font-semibold text-gray-800">üçî Combo Cheddar Burguer Triplo</h3>
                        <p class="text-sm text-gray-600 mt-1">Burger + Batata + Bebida</p>
                        <p class="text-brand-red font-bold mt-2">R$ 59,90</p>
                    </div>
                </div>
            </div>
        </section>
    </main>

    <!-- Floating Cart Button -->
    <div id="floating-cart" class="floating-cart-fixed fixed left-4 right-4 z-50 hidden" style="bottom: max(1rem, env(safe-area-inset-bottom, 0px)); padding-bottom: 0;">
        <button onclick="openCart()" class="w-full bg-brand-red text-white py-4 px-6 rounded-full shadow-lg flex items-center justify-center space-x-2 font-semibold transform transition-all duration-200 active:scale-95" role="button" aria-label="Finalizar pedido">
            <span>Finalizar Pedido</span>
            <span id="cart-count" class="bg-brand-yellow text-black px-3 py-1 rounded-full text-sm font-bold min-w-[2rem] text-center">0</span>
        </button>
    </div>

    <!-- Product Modal -->
    <div id="product-modal" class="fixed inset-0 bg-black bg-opacity-60 z-50 hidden" onclick="closeProductModal(event)">
        <div class="modal-container fixed inset-0 flex items-center justify-center p-4" style="padding-top: max(1rem, env(safe-area-inset-top)); padding-bottom: max(1rem, env(safe-area-inset-bottom));">
            <div class="modal-content bg-white rounded-2xl w-full max-w-md max-h-[85vh] shadow-2xl transform transition-all duration-300 flex flex-col modal-enter" onclick="event.stopPropagation()" style="margin-top: 0; margin-bottom: 0;">
                <div class="flex-1 overflow-y-auto">
                <div class="p-4 md:p-6">
                    <div class="flex justify-between items-center mb-4 sticky top-0 bg-white z-10 pb-2">
                        <h3 id="modal-title" class="text-xl font-bold"></h3>
                        <button onclick="closeProductModal()" class="text-gray-500 text-2xl hover:text-gray-700 p-1">&times;</button>
                    </div>
                    <img id="modal-image" class="w-full h-48 object-cover rounded-lg mb-4" alt="">
                    <div id="modal-no-image" class="hidden w-full h-48 bg-gray-200 rounded-lg mb-4 flex items-center justify-center">
                        <span class="text-gray-500">üì∑ Adicionar Foto</span>
                    </div>
                    <p id="modal-description" class="text-gray-600 mb-4"></p>
                    <p id="modal-price" class="text-2xl font-bold text-brand-red mb-4"></p>
                    


                    <!-- Crossell para Burgers -->
                    <div id="crossell-burgers" class="mb-6 hidden">
                        <div class="bg-gradient-to-r from-brand-yellow/20 to-brand-red/20 rounded-lg p-4 mb-4">
                            <h4 class="font-bold text-lg text-gray-800 mb-3 flex items-center">
                                üçü Que tal uma batata?
                            </h4>
                            <div class="grid grid-cols-1 gap-3">
                                <label class="crossell-option bg-white rounded-lg p-3 border-2 border-gray-200 cursor-pointer hover:border-brand-red transition-colors">
                                    <div class="flex items-center justify-between">
                                        <div class="flex items-center space-x-3">
                                            <input type="radio" name="batata-crossell" class="crossell w-4 h-4 text-brand-red" data-name="Batata Frita P" data-price="13.90">
                                            <div>
                                                <span class="font-medium">üçü Batata Frita P</span>
                                                <p class="text-sm text-gray-500">Por√ß√£o pequena</p>
                                            </div>
                                        </div>
                                        <span class="font-bold text-brand-red">+R$ 13,90</span>
                                    </div>
                                </label>
                                <label class="crossell-option bg-white rounded-lg p-3 border-2 border-gray-200 cursor-pointer hover:border-brand-red transition-colors">
                                    <div class="flex items-center justify-between">
                                        <div class="flex items-center space-x-3">
                                            <input type="radio" name="batata-crossell" class="crossell w-4 h-4 text-brand-red" data-name="Batata Frita M" data-price="21.90">
                                            <div>
                                                <span class="font-medium">üçü Batata Frita M</span>
                                                <p class="text-sm text-gray-500">Por√ß√£o m√©dia</p>
                                            </div>
                                        </div>
                                        <span class="font-bold text-brand-red">+R$ 21,90</span>
                                    </div>
                                </label>
                                <label class="crossell-option bg-white rounded-lg p-3 border-2 border-gray-200 cursor-pointer hover:border-brand-red transition-colors">
                                    <div class="flex items-center justify-between">
                                        <div class="flex items-center space-x-3">
                                            <input type="radio" name="batata-crossell" class="crossell w-4 h-4 text-brand-red" data-name="Batata Frita G" data-price="29.90">
                                            <div>
                                                <span class="font-medium">üçü Batata Frita G</span>
                                                <p class="text-sm text-gray-500">Por√ß√£o grande</p>
                                            </div>
                                        </div>
                                        <span class="font-bold text-brand-red">+R$ 29,90</span>
                                    </div>
                                </label>
                            </div>
                        </div>
                        
                        <div class="bg-gradient-to-r from-blue-100 to-green-100 rounded-lg p-4">
                            <h4 class="font-bold text-lg text-gray-800 mb-3 flex items-center">
                                ü•§ Adicione uma bebida
                            </h4>
                            <div class="grid grid-cols-1 gap-3">
                                <label class="crossell-option bg-white rounded-lg p-3 border-2 border-gray-200 cursor-pointer hover:border-brand-red transition-colors">
                                    <div class="flex items-center justify-between">
                                        <div class="flex items-center space-x-3">
                                            <input type="radio" name="bebida-crossell" class="crossell w-4 h-4 text-brand-red" data-name="Coca Cola 350ml" data-price="7.00">
                                            <div>
                                                <span class="font-medium">ü•§ Coca Cola</span>
                                                <p class="text-sm text-gray-500">350ml gelada</p>
                                            </div>
                                        </div>
                                        <span class="font-bold text-brand-red">+R$ 7,00</span>
                                    </div>
                                </label>
                                <label class="crossell-option bg-white rounded-lg p-3 border-2 border-gray-200 cursor-pointer hover:border-brand-red transition-colors">
                                    <div class="flex items-center justify-between">
                                        <div class="flex items-center space-x-3">
                                            <input type="radio" name="bebida-crossell" class="crossell w-4 h-4 text-brand-red" data-name="Coca Cola Zero 350ml" data-price="7.00">
                                            <div>
                                                <span class="font-medium">ü•§ Coca Cola Zero</span>
                                                <p class="text-sm text-gray-500">350ml gelada</p>
                                            </div>
                                        </div>
                                        <span class="font-bold text-brand-red">+R$ 7,00</span>
                                    </div>
                                </label>
                                <label class="crossell-option bg-white rounded-lg p-3 border-2 border-gray-200 cursor-pointer hover:border-brand-red transition-colors">
                                    <div class="flex items-center justify-between">
                                        <div class="flex items-center space-x-3">
                                            <input type="radio" name="bebida-crossell" class="crossell w-4 h-4 text-brand-red" data-name="Guaran√° Ant√°rtica 350ml" data-price="7.00">
                                            <div>
                                                <span class="font-medium">ü•§ Guaran√° Ant√°rtica</span>
                                                <p class="text-sm text-gray-500">350ml gelada</p>
                                            </div>
                                        </div>
                                        <span class="font-bold text-brand-red">+R$ 7,00</span>
                                    </div>
                                </label>
                            </div>
                        </div>
                    </div>

                    <!-- Crossell para Combos -->
                    <div id="crossell-combos" class="mb-6 hidden">
                        <div class="bg-gradient-to-r from-brand-yellow/20 to-brand-red/20 rounded-lg p-4">
                            <h4 class="font-bold text-lg text-gray-800 mb-3 flex items-center">
                                ‚¨ÜÔ∏è Aumente sua batata
                            </h4>
                            <div class="grid grid-cols-1 gap-3">
                                <label class="crossell-option bg-white rounded-lg p-3 border-2 border-gray-200 cursor-pointer hover:border-brand-red transition-colors">
                                    <div class="flex items-center justify-between">
                                        <div class="flex items-center space-x-3">
                                            <input type="radio" name="upgrade-batata" class="crossell w-4 h-4 text-brand-red" data-name="Upgrade Batata P" data-price="0.00">
                                            <div>
                                                <span class="font-medium">üçü Batata P</span>
                                                <p class="text-sm text-gray-500">Upgrade para pequena</p>
                                            </div>
                                        </div>
                                        <span class="font-bold text-green-600">GR√ÅTIS</span>
                                    </div>
                                </label>
                                <label class="crossell-option bg-white rounded-lg p-3 border-2 border-gray-200 cursor-pointer hover:border-brand-red transition-colors">
                                    <div class="flex items-center justify-between">
                                        <div class="flex items-center space-x-3">
                                            <input type="radio" name="upgrade-batata" class="crossell w-4 h-4 text-brand-red" data-name="Upgrade Batata M" data-price="7.00">
                                            <div>
                                                <span class="font-medium">üçü Batata M</span>
                                                <p class="text-sm text-gray-500">Upgrade para m√©dia</p>
                                            </div>
                                        </div>
                                        <span class="font-bold text-brand-red">+R$ 7,00</span>
                                    </div>
                                </label>
                                <label class="crossell-option bg-white rounded-lg p-3 border-2 border-gray-200 cursor-pointer hover:border-brand-red transition-colors">
                                    <div class="flex items-center justify-between">
                                        <div class="flex items-center space-x-3">
                                            <input type="radio" name="upgrade-batata" class="crossell w-4 h-4 text-brand-red" data-name="Upgrade Batata G" data-price="15.00">
                                            <div>
                                                <span class="font-medium">üçü Batata G</span>
                                                <p class="text-sm text-gray-500">Upgrade para grande</p>
                                            </div>
                                        </div>
                                        <span class="font-bold text-brand-red">+R$ 15,00</span>
                                    </div>
                                </label>
                            </div>
                        </div>
                    </div>

                    <!-- Observa√ß√µes -->
                    <div class="mb-4">
                        <label class="block font-semibold mb-2" for="observacoes">Observa√ß√µes:</label>
                        <textarea id="observacoes" class="w-full p-3 border rounded-lg resize-none" rows="3" placeholder="Alguma observa√ß√£o especial?" maxlength="200"></textarea>
                    </div>

                    <!-- Quantity and Add Button -->
                    <div class="flex items-center justify-between mb-4 gap-4">
                        <div class="flex items-center space-x-3 bg-gray-100 rounded-lg p-2">
                            <button onclick="decreaseQuantity()" class="bg-white w-10 h-10 rounded-full flex items-center justify-center font-bold text-lg shadow-sm active:scale-95 transition-transform" aria-label="Diminuir quantidade">-</button>
                            <span id="quantity" class="font-bold text-lg min-w-[2rem] text-center">1</span>
                            <button onclick="increaseQuantity()" class="bg-white w-10 h-10 rounded-full flex items-center justify-center font-bold text-lg shadow-sm active:scale-95 transition-transform" aria-label="Aumentar quantidade">+</button>
                        </div>
                        <button onclick="addToCart()" class="bg-brand-red text-white px-6 py-3 rounded-lg font-semibold flex-1 active:scale-95 transition-transform" id="add-to-cart-btn">
                            Adicionar ao Carrinho
                        </button>
                    </div>
                </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Welcome Popup -->
    <div id="welcome-popup" class="fixed inset-0 bg-black bg-opacity-50 z-60 flex items-center justify-center p-4" style="backdrop-filter: blur(2px);">
        <div class="bg-white rounded-lg max-w-sm w-full mx-4 p-6 text-center relative shadow-2xl modal-enter">
            <button onclick="closeWelcomePopup()" class="absolute top-3 right-3 text-gray-400 text-xl hover:text-gray-600 w-8 h-8 flex items-center justify-center rounded-full hover:bg-gray-100 transition-colors" aria-label="Fechar">&times;</button>
            <div class="mb-4">
                <span class="text-4xl">üçî</span>
            </div>
            <h2 class="text-xl font-bold text-brand-red mb-3">Bem-vindo √† inaugura√ß√£o da Bravari Burger!</h2>
            <p class="text-gray-700 mb-4">Este card√°pio com pre√ßo especial n√£o √© compartilh√°vel!</p>
            <div class="w-full bg-gray-200 rounded-full h-2 mb-4 overflow-hidden">
                <div id="progress-bar" class="bg-brand-red h-2 rounded-full transition-all duration-100" style="width: 100%"></div>
            </div>
            <p class="text-sm text-gray-500">Fechando automaticamente...</p>
        </div>
    </div>

    <!-- Success Notification -->
    <div id="success-notification" class="fixed top-1/2 left-1/2 transform -translate-x-1/2 -translate-y-1/2 bg-green-500 text-white px-6 py-4 rounded-lg shadow-lg z-50 opacity-0 transition-all duration-300 max-w-xs w-auto">
        <div class="flex items-center justify-center space-x-2">
            <span>‚úÖ</span>
            <span class="text-sm font-medium">Produto adicionado ao carrinho!</span>
        </div>
    </div>

    <!-- Cart Modal -->
    <div id="cart-modal" class="fixed inset-0 bg-black bg-opacity-60 z-50 hidden">
        <div class="modal-container fixed inset-0 flex items-center justify-center p-4" style="padding-top: max(1rem, env(safe-area-inset-top)); padding-bottom: max(1rem, env(safe-area-inset-bottom));">
            <div class="modal-content bg-white rounded-2xl w-full max-w-md max-h-[85vh] shadow-2xl transform transition-all duration-300 flex flex-col" style="margin-top: 0; margin-bottom: 0;">
                <div class="flex-1 overflow-y-auto">
                <div class="p-4 md:p-6">
                    <div class="flex justify-between items-center mb-4 sticky top-0 bg-white z-10 pb-2">
                        <h3 class="text-xl font-bold">Seu Pedido</h3>
                        <button onclick="closeCart()" class="text-gray-500 text-2xl hover:text-gray-700 p-1">&times;</button>
                    </div>
                    <div id="cart-items" class="space-y-4 mb-4">
                        <!-- Cart items will be inserted here -->
                    </div>
                    <!-- Coupon Section -->
                    <div class="border-t pt-4 mb-4">
                        <h4 class="font-bold text-lg mb-3">üé´ Cupons de Desconto</h4>
                        <div class="space-y-3">
                            <div class="flex space-x-2">
                                <input type="text" id="coupon-input" placeholder="Digite seu cupom" class="flex-1 p-2 border rounded-lg uppercase">
                                <button onclick="applyCoupon()" class="bg-brand-yellow text-black px-4 py-2 rounded-lg font-semibold">
                                    Aplicar
                                </button>
                            </div>
                            <div id="applied-coupons" class="space-y-2">
                                <!-- Applied coupons will appear here -->
                            </div>
                            <p class="text-xs text-gray-500">M√°ximo 2 cupons por pedido</p>
                        </div>
                    </div>
                    
                    <div class="border-t pt-4">
                        <div id="cart-summary" class="space-y-2 mb-4">
                            <div class="flex justify-between">
                                <span>Subtotal:</span>
                                <span id="cart-subtotal">R$ 0,00</span>
                            </div>
                            <div class="flex justify-between text-sm text-gray-600">
                                <span>Taxa de servi√ßo:</span>
                                <span>R$ 0,30</span>
                            </div>
                            <div id="discount-section" class="hidden">
                                <div class="flex justify-between text-green-600">
                                    <span>Desconto:</span>
                                    <span id="cart-discount">-R$ 0,00</span>
                                </div>
                            </div>
                            <div class="flex justify-between items-center text-xl font-bold border-t pt-2">
                                <span>Total:</span>
                                <span id="cart-total" class="text-brand-red">R$ 0,00</span>
                            </div>
                        </div>
                        <button onclick="openCheckout()" class="w-full bg-brand-red text-white py-3 rounded-lg font-semibold">
                            üõí Finalizar Pedido
                        </button>
                    </div>
                </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Checkout Modal -->
    <div id="checkout-modal" class="fixed inset-0 bg-black bg-opacity-60 z-50 hidden">
        <div class="modal-container fixed inset-0 flex items-center justify-center p-4" style="padding-top: max(1rem, env(safe-area-inset-top)); padding-bottom: max(1rem, env(safe-area-inset-bottom));">
            <div class="modal-content bg-white rounded-2xl w-full max-w-md max-h-[85vh] shadow-2xl transform transition-all duration-300 flex flex-col" style="margin-top: 0; margin-bottom: 0;">
                <div class="flex-1 overflow-y-auto">
                    <div class="p-4 md:p-6">
                        <div class="flex justify-between items-center mb-6 sticky top-0 bg-white z-10 pb-2">
                            <h3 class="text-xl font-bold">Finalizar Pedido</h3>
                            <button onclick="closeCheckout()" class="text-gray-500 text-2xl hover:text-gray-700 p-1">&times;</button>
                        </div>

                        <!-- Delivery Type -->
                        <div class="mb-6">
                            <h4 class="font-bold text-lg mb-3">üöö Tipo de Entrega</h4>
                            <div class="space-y-3">
                                <label class="delivery-option bg-gray-50 rounded-lg p-4 border-2 border-brand-red cursor-pointer hover:border-brand-red transition-colors block bg-brand-red/5">
                                    <div class="flex items-center space-x-3">
                                        <input type="radio" name="delivery-type" value="delivery" class="w-4 h-4 text-brand-red" checked>
                                        <div>
                                            <span class="font-medium">üõµ Delivery</span>
                                            <p class="text-sm text-gray-500">Entregamos na sua casa</p>
                                        </div>
                                    </div>
                                </label>
                                <label class="delivery-option bg-gray-50 rounded-lg p-4 border-2 border-gray-200 cursor-pointer hover:border-brand-red transition-colors block">
                                    <div class="flex items-center space-x-3">
                                        <input type="radio" name="delivery-type" value="pickup" class="w-4 h-4 text-brand-red">
                                        <div>
                                            <span class="font-medium">üè™ Retirar no Local</span>
                                            <p class="text-sm text-gray-500">Voc√™ busca na loja</p>
                                        </div>
                                    </div>
                                </label>
                            </div>
                        </div>

                        <!-- Address (only for delivery) -->
                        <div id="address-section" class="mb-6">
                            <h4 class="font-bold text-lg mb-3">üìç Endere√ßo de Entrega</h4>
                            <div class="space-y-3">
                                <input type="text" id="address" placeholder="Rua, n√∫mero" class="w-full p-3 border rounded-lg">
                                <input type="text" id="neighborhood" placeholder="Bairro" class="w-full p-3 border rounded-lg">
                                <input type="text" id="reference" placeholder="Ponto de refer√™ncia (opcional)" class="w-full p-3 border rounded-lg">
                            </div>
                        </div>

                        <!-- Payment Method -->
                        <div class="mb-6">
                            <h4 class="font-bold text-lg mb-3">üí≥ Forma de Pagamento</h4>
                            <div class="space-y-3">
                                <label class="payment-option bg-gray-50 rounded-lg p-4 border-2 border-brand-red cursor-pointer hover:border-brand-red transition-colors block bg-brand-red/5">
                                    <div class="flex items-center space-x-3">
                                        <input type="radio" name="payment-method" value="pix" class="w-4 h-4 text-brand-red" checked>
                                        <div>
                                            <span class="font-medium">üì± PIX</span>
                                            <p class="text-sm text-gray-500">Pagamento instant√¢neo</p>
                                        </div>
                                    </div>
                                </label>
                                <label class="payment-option bg-gray-50 rounded-lg p-4 border-2 border-gray-200 cursor-pointer hover:border-brand-red transition-colors block">
                                    <div class="flex items-center space-x-3">
                                        <input type="radio" name="payment-method" value="card" class="w-4 h-4 text-brand-red">
                                        <div>
                                            <span class="font-medium">üí≥ Cart√£o</span>
                                            <p class="text-sm text-gray-500">D√©bito ou cr√©dito na entrega</p>
                                        </div>
                                    </div>
                                </label>
                                <label class="payment-option bg-gray-50 rounded-lg p-4 border-2 border-gray-200 cursor-pointer hover:border-brand-red transition-colors block">
                                    <div class="flex items-center space-x-3">
                                        <input type="radio" name="payment-method" value="money" class="w-4 h-4 text-brand-red">
                                        <div>
                                            <span class="font-medium">üíµ Dinheiro</span>
                                            <p class="text-sm text-gray-500">Pagamento em esp√©cie</p>
                                        </div>
                                    </div>
                                </label>
                            </div>
                        </div>

                        <!-- Change (only for money) -->
                        <div id="change-section" class="mb-6 hidden">
                            <h4 id="change-title" class="font-bold text-lg mb-3">üí∞ Troco <span class="text-red-500">*</span></h4>
                            <div class="bg-yellow-50 rounded-lg p-4 border border-yellow-200">
                                <p class="text-sm text-gray-600 mb-3">Total do pedido: <span id="checkout-total" class="font-bold">R$ 0,00</span></p>
                                <input type="number" id="money-amount" placeholder="Valor que voc√™ tem para pagar *" class="w-full p-3 border rounded-lg" step="0.01" required>
                                <p id="change-amount" class="text-sm text-gray-600 mt-2"></p>
                                <p class="text-xs text-red-500 mt-1">* Campo obrigat√≥rio para pagamento em dinheiro</p>
                            </div>
                        </div>

                        <!-- Customer Info -->
                        <div class="mb-6">
                            <h4 class="font-bold text-lg mb-3">üë§ Seus Dados</h4>
                            <div class="space-y-3">
                                <input type="text" id="customer-name" placeholder="Seu nome" class="w-full p-3 border rounded-lg">
                                <input type="tel" id="customer-phone" placeholder="Seu telefone" class="w-full p-3 border rounded-lg">
                            </div>
                        </div>

                        <!-- Order Summary -->
                        <div class="border-t pt-4 mb-6">
                            <div class="flex justify-between items-center mb-4">
                                <span class="text-xl font-bold">Total:</span>
                                <span id="final-total" class="text-xl font-bold text-brand-red">R$ 0,00</span>
                            </div>
                        </div>

                        <button onclick="sendOrder()" class="w-full bg-green-500 text-white py-3 rounded-lg font-semibold">
                            üöÄ Enviar Pedido
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        /*
        ========================================
        üîß CONTROLE DE ESTOQUE - ALTERE AQUI! üîß
        ========================================
        
        Para alterar o estoque de qualquer produto, procure o produto na lista 'products' abaixo
        e altere o valor da propriedade 'stock':
        
        Exemplo:
        'cheddar-burger-1': {
            name: 'üçî Cheddar Burguer',
            price: 16.90,
            description: '...',
            image: '...',
            category: 'burger',
            stock: 10  ‚Üê üéØ ALTERE ESTE N√öMERO AQUI!
        }
        
        üìä Como funciona:
        - stock: 0 = Produto ESGOTADO (n√£o pode ser pedido)
        - stock: 1-3 = Estoque BAIXO (mostra "X restantes")
        - stock: 4+ = Estoque NORMAL
        
        ‚ö†Ô∏è IMPORTANTE: Altere apenas o n√∫mero ap√≥s "stock:"
        
        ========================================
        */
        
        let cart = [];
        let currentProduct = null;
        let quantity = 1;

        /*
        ========================================
        SISTEMA DE CUPONS - INSTRU√á√ïES
        ========================================
        
        Para ativar/desativar cupons, altere a propriedade 'active' para true/false:
        
        '10OFF': { discount: 10, type: 'percentage', active: true },  ‚Üê ALTERE AQUI
        
        - active: true = Cupom ativo
        - active: false = Cupom desativado
        
        Tipos de cupom:
        - percentage: desconto em porcentagem
        - free_shipping: frete gr√°tis
        - free_drink: bebida gr√°tis
        
        ========================================
        */
        
        const coupons = {
            '10OFF': { discount: 10, type: 'percentage', active: false },
            '15OFF': { discount: 15, type: 'percentage', active: false },
            '20OFF': { discount: 20, type: 'percentage', active: true },
            '30OFF': { discount: 30, type: 'percentage', active: false },
            'FRETEFREE': { discount: 0, type: 'free_shipping', active: false },
            'BEBIDAFREE': { discount: 0, type: 'free_drink', active: false }
        };
        
        let appliedCoupons = [];

        const products = {
            // Burgers
            'cheddar-burger-1': {
                name: 'üçî Cheddar Burguer',
                price: 16.90,
                description: 'Delicioso burger com queijo cheddar derretido, alface, tomate e molho especial',
                image: 'https://github.com/bravariburger/pedir/blob/main/fotos%20burguers%20-%20bravari%20burguer/Cheddar%20Burguer.jpg?raw=true',
                category: 'burger',
                stock: 100
            },
            'cheddar-bacon-burger-2': {
                name: 'üçî Cheddar Bacon Burguer',
                price: 19.90,
                description: 'Burger com cheddar cremoso e bacon crocante, alface, tomate e molho especial',
                image: 'https://github.com/bravariburger/pedir/blob/main/fotos%20burguers%20-%20bravari%20burguer/Cheddar%20Bacon%20Burguer.jpg?raw=true',
                category: 'burger',
                stock: 100
            },
            'bravari-burger-3': {
                name: 'üçî Bravari Burguer',
                price: 23.90,
                description: 'Nosso burger especial da casa com ingredientes selecionados',
                image: 'https://github.com/bravariburger/pedir/blob/main/fotos%20burguers%20-%20bravari%20burguer/Bravari%20Burguer.jpg?raw=true',
                category: 'burger',
                stock: 100
            },
            'cheddar-duplo-4': {
                name: 'üçî Cheddar Burguer Duplo',
                price: 29.90,
                description: 'Dupla dose de sabor com cheddar cremoso',
                image: 'https://github.com/bravariburger/pedir/blob/main/fotos%20burguers%20-%20bravari%20burguer/Cheddar%20Burguer%20Duplo.jpg?raw=true',
                category: 'burger',
                stock: 100
            },
            'cheddar-bacon-duplo-5': {
                name: 'üçî Cheddar Bacon Burguer Duplo',
                price: 32.90,
                description: 'Duplo prazer com cheddar e bacon crocante',
                image: 'https://github.com/bravariburger/pedir/blob/main/fotos%20burguers%20-%20bravari%20burguer/Cheddar%20Bacon%20Burguer%20Duplo.jpg?raw=true',
                category: 'burger',
                stock: 100
            },
            'bravari-duplo-6': {
                name: 'üçî Bravari Burguer Duplo',
                price: 32.90,
                description: 'Vers√£o dupla do nosso especial da casa',
                image: 'https://github.com/bravariburger/pedir/blob/main/fotos%20burguers%20-%20bravari%20burguer/Bravari%20Burguer%20Duplo.jpg?raw=true',
                category: 'burger',
                stock: 100
            },
            'bravari-bacon-triplo-7': {
                name: 'üçî Bravari Bacon Triplo',
                price: 43.90,
                description: 'Tripla dose de sabor com bacon crocante',
                image: 'https://github.com/bravariburger/pedir/blob/main/fotos%20burguers%20-%20bravari%20burguer/Bravari%20Bacon%20Triplo.jpg?raw=true',
                category: 'burger',
                stock: 100
            },
            'bravari-ring-triplo-8': {
                name: 'üçî Bravari Ring Triplo',
                price: 43.90,
                description: 'Triplo burger com onion rings crocantes',
                image: 'https://github.com/bravariburger/pedir/blob/main/fotos%20burguers%20-%20bravari%20burguer/Bravari%20Ring%20Triplo.jpg?raw=true',
                category: 'burger',
                stock: 100
            },
            'bravari-ring-9': {
                name: 'üçî Bravari Burguer Ring',
                price: 35.90,
                description: 'Burger especial com onion rings',
                image: 'https://github.com/bravariburger/pedir/blob/main/fotos%20burguers%20-%20bravari%20burguer/bravari%20burguer%20ring%20duplo.jpg?raw=true',
                category: 'burger',
                stock: 100
            },
            'vulcan-burger-10': {
                name: 'üçî Vulcan Burguer',
                price: 39.90,
                description: 'Burger picante para os corajosos',
                image: 'https://github.com/bravariburger/pedir/blob/main/fotos%20burguers%20-%20bravari%20burguer/bravari%20burguer%20ring%20duplo.jpg?raw=true',
                category: 'burger',
                stock: 0
            },
            'cream-cheese-11': {
                name: 'üçî Cream Cheese Burguer',
                price: 26.90,
                description: 'Burger cremoso com cream cheese',
                image: 'https://github.com/bravariburger/pedir/blob/main/fotos%20burguers%20-%20bravari%20burguer/bravari%20burguer%20ring%20duplo.jpg?raw=true',
                category: 'burger',
                stock: 0
            },
            'bravari-salada-12': {
                name: 'üçî Bravari Salada',
                price: 19.90,
                description: 'Op√ß√£o saud√°vel com salada fresca',
                image: 'https://github.com/bravariburger/pedir/blob/main/fotos%20burguers%20-%20bravari%20burguer/Bravari%20Salada.jpg?raw=true',
                category: 'burger',
                stock: 100
            },
            'cheddar-triplo-13': {
                name: 'üçî Cheddar Burguer Triplo',
                price: 39.90,
                description: 'Tripla dose de cheddar cremoso',
                image: 'https://github.com/bravariburger/pedir/blob/main/fotos%20burguers%20-%20bravari%20burguer/Cheddar%20Burguer%20Triplo.jpg?raw=true',
                category: 'burger',
                stock: 100
            },
            
            // Sobremesas
            'brownie-chocolate': {
                name: 'üç´ Brownie Chocolate',
                price: 9.90,
                description: 'Brownie cremoso de chocolate com peda√ßos de chocolate',
                image: 'https://github.com/bravariburger/pedir/blob/main/Sobremesas/brownie.jpg?raw=true',
                category: 'sobremesa',
                stock: 100
            },
            'brownie-branco': {
                name: 'üç´ Brownie Chocolate Branco',
                price: 9.90,
                description: 'Brownie de chocolate branco cremoso',
                image: 'https://github.com/bravariburger/pedir/blob/main/Sobremesas/brownie.jpg?raw=true',
                category: 'sobremesa',
                stock: 100
            },
            'brownie-nutella': {
                name: 'üç´ Brownie Nutella',
                price: 9.90,
                description: 'Brownie com recheio cremoso de Nutella',
                image: null,
                category: 'sobremesa',
                stock: 0
            },
            'brownie-morango': {
                name: 'üç´ Brownie Morango',
                price: 9.90,
                description: 'Brownie com cobertura de morango fresco',
                image: null,
                category: 'sobremesa',
                stock: 0
            },
            
            // Acompanhamentos
            'batata-p': {
                name: 'üçü Batata Frita P',
                price: 13.90,
                description: 'Por√ß√£o pequena de batata frita crocante',
                image: 'https://github.com/bravariburger/pedir/blob/main/Batatas/batata%20frita.jpg?raw=true',
                category: 'acompanhamento',
                stock: 100
            },
            'batata-m': {
                name: 'üçü Batata Frita M',
                price: 21.90,
                description: 'Por√ß√£o m√©dia de batata frita crocante',
                image: 'https://github.com/bravariburger/pedir/blob/main/Batatas/batata%20frita.jpg?raw=true',
                category: 'acompanhamento',
                stock: 100
            },
            'batata-g': {
                name: 'üçü Batata Frita G',
                price: 29.90,
                description: 'Por√ß√£o grande de batata frita crocante',
                image: 'https://github.com/bravariburger/pedir/blob/main/Batatas/batata%20frita.jpg?raw=true',
                category: 'acompanhamento',
                stock: 100
            },
            
            // Bebidas
            'coca-cola': {
                name: 'Coca Cola 350ml',
                price: 7.00,
                description: 'Refrigerante Coca Cola gelado',
                image: 'https://github.com/bravariburger/pedir/blob/main/Bebidas/coca.jpg?raw=true',
                category: 'bebida',
                stock: 100
            },
            'coca-zero': {
                name: 'Coca Cola Zero 350ml',
                price: 7.00,
                description: 'Refrigerante Coca Cola Zero gelado',
                image: 'https://github.com/bravariburger/pedir/blob/main/Bebidas/coca%20zero.jpg?raw=true',
                category: 'bebida',
                stock: 100
            },
            'guarana-antartica': {
                name: 'Guaran√° Ant√°rtica 350ml',
                price: 7.00,
                description: 'Refrigerante Guaran√° Ant√°rtica gelado',
                image: 'https://github.com/bravariburger/pedir/blob/main/Bebidas/giuarana%20antartica.jpg?raw=true',
                category: 'bebida',
                stock: 0
            },
            
            // Combos
            'combo-cheddar-1': {
                name: 'üçî Combo Cheddar Burguer',
                price: 37.90,
                description: 'Cheddar Burguer + Batata Frita + Refrigerante 350ml',
                image: 'https://github.com/bravariburger/pedir/blob/main/fotos%20dos%20combos%20-%20bravari%20burguer/Cheddar%20Burguer.jpg?raw=true',
                category: 'combo',
                stock: 100
            },
            'combo-cheddar-bacon-2': {
                name: 'üçî Combo Cheddar Bacon Burguer',
                price: 40.90,
                description: 'Cheddar Bacon Burguer + Batata Frita + Refrigerante 350ml',
                image: 'https://github.com/bravariburger/pedir/blob/main/fotos%20dos%20combos%20-%20bravari%20burguer/Cheddar%20Bacon%20Burguer.jpg?raw=true',
                category: 'combo',
                stock: 100
            },
            'combo-bravari-3': {
                name: 'üçî Combo Bravari Burguer',
                price: 42.90,
                description: 'Bravari Burguer + Batata Frita + Refrigerante 350ml',
                image: 'https://github.com/bravariburger/pedir/blob/main/fotos%20dos%20combos%20-%20bravari%20burguer/Bravari%20Burguer.jpg?raw=true',
                category: 'combo',
                stock: 100
            },
            'combo-cheddar-duplo-4': {
                name: 'üçî Combo Cheddar Burguer Duplo',
                price: 47.90,
                description: 'Cheddar Burguer Duplo + Batata Frita + Refrigerante 350ml',
                image: 'https://github.com/bravariburger/pedir/blob/main/fotos%20dos%20combos%20-%20bravari%20burguer/Cheddar%20Burguer%20Duplo.jpg?raw=true',
                category: 'combo',
                stock: 100
            },
            'combo-cheddar-bacon-duplo-5': {
                name: 'üçî Combo Cheddar Bacon Burguer Duplo',
                price: 49.90,
                description: 'Cheddar Bacon Burguer Duplo + Batata Frita + Refrigerante 350ml',
                image: 'https://github.com/bravariburger/pedir/blob/main/fotos%20dos%20combos%20-%20bravari%20burguer/Cheddar%20Bacon%20Burguer%20Duplo.jpg?raw=true',
                category: 'combo',
                stock: 100
            },
            'combo-bravari-duplo-6': {
                name: 'üçî Combo Bravari Burguer Duplo',
                price: 49.90,
                description: 'Bravari Burguer Duplo + Batata Frita + Refrigerante 350ml',
                image: 'https://github.com/bravariburger/pedir/blob/main/fotos%20dos%20combos%20-%20bravari%20burguer/Bravari%20Burguer%20Duplo.jpg?raw=true',
                category: 'combo',
                stock: 100
            },
            'combo-bravari-bacon-triplo-7': {
                name: 'üçî Combo Bravari Bacon Triplo',
                price: 59.90,
                description: 'Bravari Bacon Triplo + Batata Frita + Refrigerante 350ml',
                image: 'https://github.com/bravariburger/pedir/blob/main/fotos%20dos%20combos%20-%20bravari%20burguer/Bravari%20Bacon%20Triplo.jpg?raw=true',
                category: 'combo',
                stock: 100
            },
            'combo-bravari-ring-triplo-8': {
                name: 'üçî Combo Bravari Ring Triplo',
                price: 59.90,
                description: 'Bravari Ring Triplo + Batata Frita + Refrigerante 350ml',
                image: 'https://github.com/bravariburger/pedir/blob/main/fotos%20dos%20combos%20-%20bravari%20burguer/Bravari%20Ring%20Triplo.jpg?raw=true',
                category: 'combo',
                stock: 100
            },
            'combo-bravari-ring-9': {
                name: 'üçî Combo Bravari Burguer Ring',
                price: 53.90,
                description: 'Bravari Burguer Ring + Batata Frita + Refrigerante 350ml',
                image: 'https://github.com/bravariburger/pedir/blob/main/fotos%20dos%20combos%20-%20bravari%20burguer/bravari%20burguer%20ring%20duplo.jpg?raw=true',
                category: 'combo',
                stock: 100
            },
            'combo-vulcan-10': {
                name: 'üçî Combo Vulcan Burguer',
                price: 59.90,
                description: 'Vulcan Burguer + Batata Frita + Refrigerante 350ml',
                image: 'https://github.com/bravariburger/pedir/blob/main/fotos%20dos%20combos%20-%20bravari%20burguer/bravari%20burguer%20ring%20duplo.jpg?raw=true',
                category: 'combo',
                stock: 0
            },
            'combo-cream-cheese-11': {
                name: 'üçî Combo Cream Cheese Burguer',
                price: 45.90,
                description: 'Cream Cheese Burguer + Batata Frita + Refrigerante 350ml',
                image: 'https://github.com/bravariburger/pedir/blob/main/fotos%20dos%20combos%20-%20bravari%20burguer/bravari%20burguer%20ring%20duplo.jpg?raw=true',
                category: 'combo',
                stock: 0
            },
            'combo-bravari-salada-12': {
                name: 'üçî Combo Bravari Salada',
                price: 37.90,
                description: 'Bravari Salada + Batata Frita + Refrigerante 350ml',
                image: 'https://github.com/bravariburger/pedir/blob/main/fotos%20dos%20combos%20-%20bravari%20burguer/Bravari%20Burguer.jpg?raw=true',
                category: 'combo',
                stock: 100
            },
            'combo-cheddar-triplo-13': {
                name: 'üçî Combo Cheddar Burguer Triplo',
                price: 59.90,
                description: 'Cheddar Burguer Triplo + Batata Frita + Refrigerante 350ml',
                image: 'https://raw.githubusercontent.com/bravariburger/inaugura-o/refs/heads/main/combos%20JPG/7.jpg',
                category: 'combo',
                stock: 100
            }
        };

        function scrollToCategory(categoryId) {
            const element = document.getElementById(categoryId);
            if (!element) return;
            
            element.scrollIntoView({ behavior: 'smooth', block: 'start' });
            
            // Update active category button with debouncing
            requestAnimationFrame(() => {
                document.querySelectorAll('.category-btn').forEach(btn => {
                    btn.classList.remove('bg-brand-red', 'text-white');
                    btn.classList.add('bg-gray-200', 'text-gray-700');
                });
                event.target.classList.remove('bg-gray-200', 'text-gray-700');
                event.target.classList.add('bg-brand-red', 'text-white');
            });
        }

        function openProductModal(productId) {
            // Prevent double-tap zoom on mobile
            if (window.lastModalOpen && Date.now() - window.lastModalOpen < 300) return;
            window.lastModalOpen = Date.now();
            
            currentProduct = products[productId] || {
                name: productId.replace(/-/g, ' ').replace(/\b\w/g, l => l.toUpperCase()),
                price: 19.90,
                description: 'Produto delicioso preparado com ingredientes frescos',
                image: null,
                category: 'other',
                stock: 0
            };
            
            // Check if product is out of stock
            if (currentProduct.stock === 0) {
                showNotification('Produto indispon√≠vel no momento!', 'error');
                return;
            }
            
            // Update modal content
            const modalTitle = document.getElementById('modal-title');
            const modalDescription = document.getElementById('modal-description');
            const modalPrice = document.getElementById('modal-price');
            
            if (modalTitle) modalTitle.textContent = currentProduct.name;
            if (modalDescription) modalDescription.textContent = currentProduct.description;
            if (modalPrice) modalPrice.textContent = `R$ ${currentProduct.price.toFixed(2).replace('.', ',')}`;
            
            // Handle image loading
            const modalImage = document.getElementById('modal-image');
            const modalNoImage = document.getElementById('modal-no-image');
            
            if (currentProduct.image && modalImage && modalNoImage) {
                modalImage.src = currentProduct.image;
                modalImage.style.display = 'block';
                modalNoImage.style.display = 'none';
                modalImage.onerror = function() {
                    this.style.display = 'none';
                    modalNoImage.style.display = 'flex';
                };
            } else if (modalImage && modalNoImage) {
                modalImage.style.display = 'none';
                modalNoImage.style.display = 'flex';
            }
            
            // Show/hide crossell sections based on category
            const crossellBurgers = document.getElementById('crossell-burgers');
            const crossellCombos = document.getElementById('crossell-combos');
            
            if (crossellBurgers && crossellCombos) {
                if (currentProduct.category === 'burger') {
                    crossellBurgers.classList.remove('hidden');
                    crossellCombos.classList.add('hidden');
                } else if (currentProduct.category === 'combo') {
                    crossellBurgers.classList.add('hidden');
                    crossellCombos.classList.remove('hidden');
                } else {
                    crossellBurgers.classList.add('hidden');
                    crossellCombos.classList.add('hidden');
                }
            }
            
            // Reset form
            quantity = 1;
            const quantityEl = document.getElementById('quantity');
            if (quantityEl) quantityEl.textContent = quantity;
            
            document.querySelectorAll('.crossell').forEach(cb => cb.checked = false);
            const observacoesEl = document.getElementById('observacoes');
            if (observacoesEl) observacoesEl.value = '';
            
            // Prevent body scroll and show modal
            document.body.style.overflow = 'hidden';
            document.body.classList.add('modal-open');
            
            const modal = document.getElementById('product-modal');
            if (modal) {
                modal.classList.remove('hidden');
                
                // Force reflow to ensure proper centering on mobile
                requestAnimationFrame(() => {
                    const modalContainer = modal.querySelector('.modal-container');
                    const modalContent = modal.querySelector('.modal-content');
                    
                    if (modalContainer && modalContent) {
                        modalContainer.style.display = 'flex';
                        modalContainer.style.alignItems = 'center';
                        modalContainer.style.justifyContent = 'center';
                        modalContent.style.margin = '0';
                    }
                    
                    // Add focus trap
                    modal.focus();
                });
            }
        }

        function closeProductModal(event) {
            // Only close if clicking on backdrop or close button
            if (event && event.target !== event.currentTarget && !event.target.closest('.close-modal')) return;
            
            const modal = document.getElementById('product-modal');
            if (modal) {
                modal.classList.add('hidden');
            }
            // Restore body scroll
            document.body.style.overflow = '';
            document.body.classList.remove('modal-open');
        }
        
        function showNotification(message, type = 'success') {
            const notification = document.getElementById('success-notification');
            if (!notification) return;
            
            const icon = type === 'error' ? '‚ùå' : '‚úÖ';
            const bgColor = type === 'error' ? 'bg-red-500' : 'bg-green-500';
            
            notification.className = `fixed top-1/2 left-1/2 transform -translate-x-1/2 -translate-y-1/2 ${bgColor} text-white px-6 py-4 rounded-lg shadow-lg z-50 opacity-0 transition-all duration-300 max-w-xs w-auto`;
            notification.innerHTML = `
                <div class="flex items-center justify-center space-x-2">
                    <span>${icon}</span>
                    <span class="text-sm font-medium">${message}</span>
                </div>
            `;
            
            notification.style.opacity = '1';
            notification.style.transform = 'translate(-50%, -50%) scale(1)';
            
            setTimeout(() => {
                notification.style.opacity = '0';
                notification.style.transform = 'translate(-50%, -50%) scale(0.9)';
            }, 3000);
        }

        function increaseQuantity() {
            quantity++;
            document.getElementById('quantity').textContent = quantity;
        }

        function decreaseQuantity() {
            if (quantity > 1) {
                quantity--;
                document.getElementById('quantity').textContent = quantity;
            }
        }

        function addToCart() {
            if (!currentProduct) return;
            
            // Show loading state
            const addBtn = document.getElementById('add-to-cart-btn');
            if (addBtn) {
                addBtn.classList.add('loading');
                addBtn.textContent = 'Adicionando...';
            }
            
            // Check if there's enough stock
            if (currentProduct.stock < quantity) {
                showNotification(`Estoque insuficiente! Apenas ${currentProduct.stock} unidades dispon√≠veis.`, 'error');
                if (addBtn) {
                    addBtn.classList.remove('loading');
                    addBtn.textContent = 'Adicionar ao Carrinho';
                }
                return;
            }
            
            const crossells = [];
            let additionalPrice = 0;
            
            document.querySelectorAll('.crossell:checked').forEach(cb => {
                const name = cb.dataset.name;
                const price = parseFloat(cb.dataset.price) || 0;
                crossells.push({ name, price });
                additionalPrice += price;
            });
            
            const observacoesEl = document.getElementById('observacoes');
            const observacoes = observacoesEl ? observacoesEl.value.trim() : '';
            const totalPrice = (currentProduct.price + additionalPrice) * quantity;
            
            const cartItem = {
                id: Date.now() + Math.random(), // Ensure unique ID
                name: currentProduct.name,
                price: currentProduct.price,
                quantity: quantity,
                crossells: crossells,
                observacoes: observacoes,
                totalPrice: totalPrice,
                productId: Object.keys(products).find(key => products[key] === currentProduct)
            };
            
            // Reduce stock temporarily (will be restored if order is not completed)
            currentProduct.stock -= quantity;
            
            cart.push(cartItem);
            
            // Use requestAnimationFrame for smooth UI updates
            requestAnimationFrame(() => {
                updateCartUI();
                updateStockDisplay();
                showNotification('Produto adicionado ao carrinho!');
                closeProductModal();
                
                if (addBtn) {
                    addBtn.classList.remove('loading');
                    addBtn.textContent = 'Adicionar ao Carrinho';
                }
            });
        }

        function closeWelcomePopup() {
            document.getElementById('welcome-popup').style.display = 'none';
        }

        function initWelcomePopup() {
            const popup = document.getElementById('welcome-popup');
            const progressBar = document.getElementById('progress-bar');
            let width = 100;
            
            const interval = setInterval(() => {
                width -= 2;
                progressBar.style.width = width + '%';
                
                if (width <= 0) {
                    clearInterval(interval);
                    closeWelcomePopup();
                }
            }, 100);
        }

        function showSuccessNotification(message = 'Produto adicionado ao carrinho!') {
            const notification = document.getElementById('success-notification');
            notification.querySelector('span:last-child').textContent = message;
            notification.style.opacity = '1';
            notification.style.transform = 'translate(-50%, -50%) scale(1)';
            
            setTimeout(() => {
                notification.style.opacity = '0';
                notification.style.transform = 'translate(-50%, -50%) scale(0.9)';
            }, 2000);
        }

        function applyCoupon() {
            const couponInput = document.getElementById('coupon-input');
            const couponCode = couponInput.value.toUpperCase().trim();
            
            if (!couponCode) {
                alert('Digite um cupom v√°lido');
                return;
            }
            
            if (appliedCoupons.length >= 2) {
                alert('M√°ximo 2 cupons por pedido');
                return;
            }
            
            if (appliedCoupons.some(c => c.code === couponCode)) {
                alert('Cupom j√° aplicado');
                return;
            }
            
            const coupon = coupons[couponCode];
            if (!coupon || !coupon.active) {
                alert('Cupom inv√°lido ou expirado');
                return;
            }
            
            appliedCoupons.push({
                code: couponCode,
                ...coupon
            });
            
            couponInput.value = '';
            updateCartUI();
            showSuccessNotification('Cupom aplicado com sucesso!');
        }
        
        function removeCoupon(couponCode) {
            appliedCoupons = appliedCoupons.filter(c => c.code !== couponCode);
            updateCartUI();
        }
        
        function calculateDiscount(subtotal) {
            let totalDiscount = 0;
            let hasFreeShipping = false;
            let hasFreeDrink = false;
            let discountDetails = [];
            
            appliedCoupons.forEach(coupon => {
                if (coupon.type === 'percentage') {
                    const discount = (subtotal * coupon.discount / 100);
                    totalDiscount += discount;
                    discountDetails.push({
                        code: coupon.code,
                        type: 'percentage',
                        value: discount,
                        description: `${coupon.discount}% de desconto`
                    });
                } else if (coupon.type === 'free_shipping') {
                    hasFreeShipping = true;
                    discountDetails.push({
                        code: coupon.code,
                        type: 'free_shipping',
                        value: 0,
                        description: 'Frete gr√°tis'
                    });
                } else if (coupon.type === 'free_drink') {
                    // Check if there's a drink in cart and other items
                    const hasDrink = cart.some(item => products[item.productId] && products[item.productId].category === 'bebida');
                    const hasOtherItems = cart.some(item => products[item.productId] && products[item.productId].category !== 'bebida');
                    
                    if (hasDrink && hasOtherItems) {
                        hasFreeDrink = true;
                        totalDiscount += 7.00;
                        discountDetails.push({
                            code: coupon.code,
                            type: 'free_drink',
                            value: 7.00,
                            description: 'Bebida gr√°tis'
                        });
                    } else {
                        discountDetails.push({
                            code: coupon.code,
                            type: 'free_drink_invalid',
                            value: 0,
                            description: 'Bebida gr√°tis (inv√°lido - precisa de bebida + outro item)'
                        });
                    }
                }
            });
            
            return {
                discount: totalDiscount,
                hasFreeShipping,
                hasFreeDrink,
                details: discountDetails
            };
        }

        function updateCartUI() {
            const cartCount = cart.reduce((sum, item) => sum + item.quantity, 0);
            const floatingCart = document.getElementById('floating-cart');
            
            if (cartCount > 0) {
                floatingCart.classList.remove('hidden');
                document.getElementById('cart-count').textContent = cartCount;
            } else {
                floatingCart.classList.add('hidden');
            }
            
            // Update applied coupons display
            const appliedCouponsEl = document.getElementById('applied-coupons');
            if (appliedCouponsEl) {
                appliedCouponsEl.innerHTML = '';
                
                // Calculate discount to get details
                const subtotal = cart.reduce((sum, item) => sum + item.totalPrice, 0);
                const discountInfo = calculateDiscount(subtotal);
                
                discountInfo.details.forEach(detail => {
                    const isInvalid = detail.type === 'free_drink_invalid';
                    const bgColor = isInvalid ? 'bg-red-50 border-red-200' : 'bg-green-50 border-green-200';
                    const textColor = isInvalid ? 'text-red-700' : 'text-green-700';
                    const descColor = isInvalid ? 'text-red-600' : 'text-green-600';
                    
                    appliedCouponsEl.innerHTML += `
                        <div class="flex items-center justify-between ${bgColor} rounded-lg p-2">
                            <div>
                                <span class="font-semibold ${textColor}">${detail.code}</span>
                                <p class="text-xs ${descColor}">${detail.description}</p>
                                ${detail.value > 0 ? `<p class="text-xs ${descColor}">-R$ ${detail.value.toFixed(2).replace('.', ',')}</p>` : ''}
                            </div>
                            <button onclick="removeCoupon('${detail.code}')" class="text-red-500 text-sm">‚úï</button>
                        </div>
                    `;
                });
            }
        }

        function openCart() {
            const cartItems = document.getElementById('cart-items');
            const cartSubtotal = document.getElementById('cart-subtotal');
            const cartDiscount = document.getElementById('cart-discount');
            const cartTotal = document.getElementById('cart-total');
            const discountSection = document.getElementById('discount-section');
            
            cartItems.innerHTML = '';
            let subtotal = 0;
            
            cart.forEach((item, index) => {
                subtotal += item.totalPrice;
                
                const crossellsText = item.crossells && item.crossells.length > 0 
                    ? item.crossells.map(c => c.name).join(', ')
                    : '';
                
                cartItems.innerHTML += `
                    <div class="border-b pb-4">
                        <div class="flex justify-between items-start">
                            <div class="flex-1">
                                <h4 class="font-semibold">${item.name}</h4>
                                <p class="text-sm text-gray-600">Qtd: ${item.quantity}</p>
                                ${crossellsText ? `<p class="text-sm text-gray-600">Extras: ${crossellsText}</p>` : ''}
                                ${item.observacoes ? `<p class="text-sm text-gray-600">Obs: ${item.observacoes}</p>` : ''}
                            </div>
                            <div class="text-right">
                                <p class="font-semibold">R$ ${item.totalPrice.toFixed(2).replace('.', ',')}</p>
                                <button onclick="removeFromCart(${index})" class="text-red-500 text-sm">Remover</button>
                            </div>
                        </div>
                    </div>
                `;
            });
            
            // Calculate discount
            const discountInfo = calculateDiscount(subtotal);
            const serviceFee = 0.30;
            const total = subtotal + serviceFee - discountInfo.discount;
            
            cartSubtotal.textContent = `R$ ${subtotal.toFixed(2).replace('.', ',')}`;
            
            if (discountInfo.discount > 0) {
                discountSection.classList.remove('hidden');
                cartDiscount.textContent = `-R$ ${discountInfo.discount.toFixed(2).replace('.', ',')}`;
            } else {
                discountSection.classList.add('hidden');
            }
            
            cartTotal.textContent = `R$ ${total.toFixed(2).replace('.', ',')}`;
            
            // Prevent body scroll
            document.body.style.overflow = 'hidden';
            document.body.classList.add('modal-open');
            
            const cartModal = document.getElementById('cart-modal');
            cartModal.classList.remove('hidden');
            
            // Force proper centering on mobile
            requestAnimationFrame(() => {
                const modalContainer = cartModal.querySelector('.modal-container');
                const modalContent = cartModal.querySelector('.modal-content');
                
                if (modalContainer && modalContent) {
                    modalContainer.style.display = 'flex';
                    modalContainer.style.alignItems = 'center';
                    modalContainer.style.justifyContent = 'center';
                    modalContent.style.margin = '0';
                }
            });
        }

        function closeCart() {
            document.getElementById('cart-modal').classList.add('hidden');
            // Restore body scroll
            document.body.style.overflow = '';
            document.body.classList.remove('modal-open');
        }

        function removeFromCart(index) {
            const item = cart[index];
            
            // Restore stock
            if (item.productId && products[item.productId]) {
                products[item.productId].stock += item.quantity;
            }
            
            cart.splice(index, 1);
            updateCartUI();
            updateStockDisplay();
            
            if (cart.length === 0) {
                closeCart();
            } else {
                openCart();
            }
        }

        function openCheckout() {
            if (cart.length === 0) return;
            
            const subtotal = cart.reduce((sum, item) => sum + item.totalPrice, 0);
            const discountInfo = calculateDiscount(subtotal);
            const serviceFee = 0.30;
            const finalTotal = subtotal + serviceFee - discountInfo.discount;
            
            document.getElementById('checkout-total').textContent = `R$ ${finalTotal.toFixed(2).replace('.', ',')}`;
            document.getElementById('final-total').textContent = `R$ ${finalTotal.toFixed(2).replace('.', ',')}`;
            
            // Prevent body scroll
            document.body.style.overflow = 'hidden';
            document.body.classList.add('modal-open');
            
            const checkoutModal = document.getElementById('checkout-modal');
            checkoutModal.classList.remove('hidden');
            
            // Force proper centering on mobile
            requestAnimationFrame(() => {
                const modalContainer = checkoutModal.querySelector('.modal-container');
                const modalContent = checkoutModal.querySelector('.modal-content');
                
                if (modalContainer && modalContent) {
                    modalContainer.style.display = 'flex';
                    modalContainer.style.alignItems = 'center';
                    modalContainer.style.justifyContent = 'center';
                    modalContent.style.margin = '0';
                }
            });
            
            closeCart();
        }

        function closeCheckout() {
            document.getElementById('checkout-modal').classList.add('hidden');
            // Restore body scroll
            document.body.style.overflow = '';
            document.body.classList.remove('modal-open');
        }

        // Advanced Validation System
        class ValidationManager {
            constructor() {
                this.rules = {
                    name: {
                        required: true,
                        minLength: 2,
                        maxLength: 50,
                        pattern: /^[a-zA-Z√Ä-√ø\s]+$/,
                        message: 'Nome deve conter apenas letras e espa√ßos'
                    },
                    phone: {
                        required: true,
                        minLength: 10,
                        maxLength: 15,
                        pattern: /^[\d\s\(\)\-\+]+$/,
                        message: 'Telefone deve conter apenas n√∫meros e s√≠mbolos v√°lidos'
                    },
                    address: {
                        required: true,
                        minLength: 5,
                        maxLength: 100,
                        message: 'Endere√ßo deve ter entre 5 e 100 caracteres'
                    },
                    neighborhood: {
                        required: true,
                        minLength: 2,
                        maxLength: 50,
                        message: 'Bairro deve ter entre 2 e 50 caracteres'
                    }
                };
                this.init();
            }
            
            init() {
                this.setupRealTimeValidation();
                this.setupFormSubmissionValidation();
            }
            
            setupRealTimeValidation() {
                // Real-time validation for inputs
                document.addEventListener('input', (e) => {
                    if (e.target.matches('#customer-name, #customer-phone, #address, #neighborhood')) {
                        this.validateField(e.target);
                    }
                });
                
                // Format phone number as user types
                document.addEventListener('input', (e) => {
                    if (e.target.id === 'customer-phone') {
                        this.formatPhoneNumber(e.target);
                    }
                });
            }
            
            validateField(field) {
                const fieldName = this.getFieldName(field.id);
                const rule = this.rules[fieldName];
                if (!rule) return true;
                
                const value = field.value.trim();
                const errors = [];
                
                // Required validation
                if (rule.required && !value) {
                    errors.push('Este campo √© obrigat√≥rio');
                }
                
                if (value) {
                    // Length validation
                    if (rule.minLength && value.length < rule.minLength) {
                        errors.push(`M√≠nimo ${rule.minLength} caracteres`);
                    }
                    
                    if (rule.maxLength && value.length > rule.maxLength) {
                        errors.push(`M√°ximo ${rule.maxLength} caracteres`);
                    }
                    
                    // Pattern validation
                    if (rule.pattern && !rule.pattern.test(value)) {
                        errors.push(rule.message);
                    }
                    
                    // Custom validations
                    if (fieldName === 'phone') {
                        const cleanPhone = value.replace(/\D/g, '');
                        if (cleanPhone.length < 10 || cleanPhone.length > 11) {
                            errors.push('Telefone deve ter 10 ou 11 d√≠gitos');
                        }
                    }
                }
                
                this.showFieldValidation(field, errors);
                return errors.length === 0;
            }
            
            showFieldValidation(field, errors) {
                // Remove existing validation
                const existingError = field.parentElement.querySelector('.validation-error');
                if (existingError) {
                    existingError.remove();
                }
                
                field.classList.remove('border-red-500', 'border-green-500');
                
                if (errors.length > 0) {
                    field.classList.add('border-red-500');
                    
                    const errorDiv = document.createElement('div');
                    errorDiv.className = 'validation-error text-red-500 text-sm mt-1';
                    errorDiv.textContent = errors[0];
                    field.parentElement.appendChild(errorDiv);
                } else if (field.value.trim()) {
                    field.classList.add('border-green-500');
                }
            }
            
            formatPhoneNumber(field) {
                let value = field.value.replace(/\D/g, '');
                
                if (value.length <= 11) {
                    if (value.length <= 2) {
                        value = value.replace(/(\d{0,2})/, '($1');
                    } else if (value.length <= 7) {
                        value = value.replace(/(\d{2})(\d{0,5})/, '($1) $2');
                    } else if (value.length <= 10) {
                        value = value.replace(/(\d{2})(\d{4})(\d{0,4})/, '($1) $2-$3');
                    } else {
                        value = value.replace(/(\d{2})(\d{5})(\d{0,4})/, '($1) $2-$3');
                    }
                }
                
                field.value = value;
            }
            
            getFieldName(fieldId) {
                const mapping = {
                    'customer-name': 'name',
                    'customer-phone': 'phone',
                    'address': 'address',
                    'neighborhood': 'neighborhood'
                };
                return mapping[fieldId] || fieldId;
            }
            
            validateForm() {
                const fields = document.querySelectorAll('#customer-name, #customer-phone, #address, #neighborhood');
                let isValid = true;
                
                fields.forEach(field => {
                    // Skip address fields if pickup is selected
                    const deliveryType = document.querySelector('input[name="delivery-type"]:checked')?.value;
                    if (deliveryType === 'pickup' && (field.id === 'address' || field.id === 'neighborhood')) {
                        return;
                    }
                    
                    if (!this.validateField(field)) {
                        isValid = false;
                    }
                });
                
                return isValid;
            }
            
            setupFormSubmissionValidation() {
                // Prevent form submission if invalid
                document.addEventListener('click', (e) => {
                    if (e.target.textContent?.includes('Enviar Pedido')) {
                        if (!this.validateForm()) {
                            e.preventDefault();
                            showNotification('Por favor, corrija os erros no formul√°rio', 'error');
                        }
                    }
                });
            }
        }
        
        // Enhanced Security Manager
        class SecurityManager {
            constructor() {
                this.maxAttempts = 5;
                this.attempts = 0;
                this.blockedUntil = null;
                this.init();
            }
            
            init() {
                this.setupCSRFProtection();
                this.setupRateLimiting();
                this.setupInputSanitization();
            }
            
            setupCSRFProtection() {
                // Generate session token
                if (!sessionStorage.getItem('sessionToken')) {
                    sessionStorage.setItem('sessionToken', this.generateToken());
                }
            }
            
            generateToken() {
                return Math.random().toString(36).substring(2) + Date.now().toString(36);
            }
            
            setupRateLimiting() {
                const originalSendOrder = window.sendOrder;
                window.sendOrder = () => {
                    if (this.isBlocked()) {
                        const remainingTime = Math.ceil((this.blockedUntil - Date.now()) / 1000);
                        showNotification(`Muitas tentativas. Tente novamente em ${remainingTime}s`, 'error');
                        return;
                    }
                    
                    this.attempts++;
                    if (this.attempts >= this.maxAttempts) {
                        this.blockedUntil = Date.now() + 300000; // 5 minutes
                        showNotification('Muitas tentativas. Bloqueado por 5 minutos.', 'error');
                        return;
                    }
                    
                    originalSendOrder();
                };
            }
            
            isBlocked() {
                return this.blockedUntil && Date.now() < this.blockedUntil;
            }
            
            setupInputSanitization() {
                document.addEventListener('input', (e) => {
                    if (e.target.matches('input, textarea')) {
                        e.target.value = this.sanitizeInput(e.target.value);
                    }
                });
            }
            
            sanitizeInput(input) {
                // Remove potentially dangerous characters
                return input
                    .replace(/<script\b[^<]*(?:(?!<\/script>)<[^<]*)*<\/script>/gi, '')
                    .replace(/javascript:/gi, '')
                    .replace(/on\w+\s*=/gi, '');
            }
        }
        
        function sendOrder() {
            if (cart.length === 0) return;
            
            const deliveryType = document.querySelector('input[name="delivery-type"]:checked')?.value;
            const paymentMethod = document.querySelector('input[name="payment-method"]:checked')?.value;
            const customerName = document.getElementById('customer-name')?.value?.trim();
            const customerPhone = document.getElementById('customer-phone')?.value?.trim();
            
            // Simple validation
            if (!customerName || !customerPhone) {
                showNotification('Por favor, preencha seu nome e telefone', 'error');
                return;
            }
            
            if (deliveryType === 'delivery') {
                const address = document.getElementById('address')?.value?.trim();
                const neighborhood = document.getElementById('neighborhood')?.value?.trim();
                if (!address || !neighborhood) {
                    showNotification('Por favor, preencha o endere√ßo completo', 'error');
                    return;
                }
            }
            
            // Valida√ß√£o obrigat√≥ria do troco para pagamento em dinheiro
            if (paymentMethod === 'money') {
                const moneyAmount = parseFloat(document.getElementById('money-amount').value);
                const subtotalForValidation = cart.reduce((sum, item) => sum + item.totalPrice, 0);
                const discountInfoForValidation = calculateDiscount(subtotalForValidation);
                const serviceFeeForValidation = 0.30;
                const finalTotalForValidation = subtotalForValidation + serviceFeeForValidation - discountInfoForValidation.discount;
                
                if (!moneyAmount || isNaN(moneyAmount)) {
                    showNotification('Por favor, informe o valor que voc√™ tem para pagar', 'error');
                    document.getElementById('money-amount').focus();
                    return;
                }
                
                if (moneyAmount < finalTotalForValidation) {
                    showNotification('O valor informado √© insuficiente para o pagamento', 'error');
                    document.getElementById('money-amount').focus();
                    return;
                }
            }
            
            let message = "üçî *NOVO PEDIDO - BRAVARI BURGER* üçî\n\n";
            
            // Customer info
            message += `üë§ *CLIENTE:* ${customerName}\n`;
            message += `üì± *TELEFONE:* ${customerPhone}\n\n`;
            
            // Delivery type
            if (deliveryType === 'delivery') {
                const address = document.getElementById('address').value;
                const neighborhood = document.getElementById('neighborhood').value;
                const reference = document.getElementById('reference').value;
                
                if (!address || !neighborhood) {
                    alert('Por favor, preencha o endere√ßo completo');
                    return;
                }
                
                message += `üöö *ENTREGA:* Delivery\n`;
                message += `üìç *ENDERE√áO:* ${address}, ${neighborhood}\n`;
                if (reference) {
                    message += `üè† *REFER√äNCIA:* ${reference}\n`;
                }
            } else {
                message += `üè™ *ENTREGA:* Retirar no Local\n`;
            }
            
            // Payment method
            let paymentText = '';
            switch(paymentMethod) {
                case 'pix': paymentText = 'üì± PIX'; break;
                case 'card': paymentText = 'üí≥ Cart√£o na entrega'; break;
                case 'money': paymentText = 'üíµ Dinheiro'; break;
            }
            message += `üí≥ *PAGAMENTO:* ${paymentText}\n`;
            
            // Change for money payment
            if (paymentMethod === 'money') {
                const moneyAmount = parseFloat(document.getElementById('money-amount').value);
                const subtotalForChange = cart.reduce((sum, item) => sum + item.totalPrice, 0);
                const discountInfoForChange = calculateDiscount(subtotalForChange);
                const serviceFeeForChange = 0.30;
                const finalTotalForChange = subtotalForChange + serviceFeeForChange - discountInfoForChange.discount;
                
                if (moneyAmount && moneyAmount > finalTotalForChange) {
                    const change = moneyAmount - finalTotalForChange;
                    message += `üí∞ *TROCO PARA:* R$ ${moneyAmount.toFixed(2).replace('.', ',')}\n`;
                    message += `üí∞ *TROCO:* R$ ${change.toFixed(2).replace('.', ',')}\n`;
                }
            }
            
            message += "\nüìã *ITENS DO PEDIDO:*\n\n";
            
            let subtotal = 0;
            cart.forEach((item, index) => {
                message += `${index + 1}. *${item.name}*\n`;
                message += `   Quantidade: ${item.quantity}\n`;
                message += `   Pre√ßo unit√°rio: R$ ${item.price.toFixed(2).replace('.', ',')}\n`;
                
                if (item.crossells && item.crossells.length > 0) {
                    message += `   Extras:\n`;
                    item.crossells.forEach(crossell => {
                        message += `   ‚Ä¢ ${crossell.name} (+R$ ${crossell.price.toFixed(2).replace('.', ',')})\n`;
                    });
                }
                
                if (item.observacoes) {
                    message += `   Observa√ß√µes: ${item.observacoes}\n`;
                }
                
                message += `   Subtotal: R$ ${item.totalPrice.toFixed(2).replace('.', ',')}\n\n`;
                subtotal += item.totalPrice;
            });
            
            // Calculate discount and show details
            const discountInfo = calculateDiscount(subtotal);
            
            message += `üí∞ *SUBTOTAL: R$ ${subtotal.toFixed(2).replace('.', ',')}*\n`;
            message += `üîß *TAXA DE SERVI√áO: R$ 0,30*\n`;
            
            // Show applied coupons and discounts
            if (appliedCoupons.length > 0) {
                message += "\nüé´ *CUPONS APLICADOS:*\n";
                discountInfo.details.forEach(detail => {
                    message += `‚Ä¢ ${detail.code} - ${detail.description}`;
                    if (detail.value > 0) {
                        message += ` (-R$ ${detail.value.toFixed(2).replace('.', ',')})`;
                    }
                    message += "\n";
                });
                
                if (discountInfo.discount > 0) {
                    message += `\nüí∏ *DESCONTO TOTAL: -R$ ${discountInfo.discount.toFixed(2).replace('.', ',')}*\n`;
                }
            }
            
            const serviceFee = 0.30;
            const finalTotal = subtotal + serviceFee - discountInfo.discount;
            message += `\nüí∞ *TOTAL FINAL: R$ ${finalTotal.toFixed(2).replace('.', ',')}*\n\n`;
            message += "üöÄ *PEDIDO ENVIADO!*";
            
            const whatsappNumber = "5521959549941";
            const encodedMessage = encodeURIComponent(message);
            const whatsappURL = `https://wa.me/${whatsappNumber}?text=${encodedMessage}`;
            
            window.open(whatsappURL, '_blank');
        }

        // Initialize stock display
        function updateStockDisplay() {
            Object.keys(products).forEach(productId => {
                const product = products[productId];
                const productCard = document.querySelector(`[onclick="openProductModal('${productId}')"]`);
                
                if (productCard) {
                    if (product.stock === 0) {
                        // Add out of stock styling
                        productCard.classList.add('opacity-50', 'cursor-not-allowed');
                        productCard.onclick = null;
                        
                        // Add out of stock badge
                        if (!productCard.querySelector('.stock-badge')) {
                            const badge = document.createElement('div');
                            badge.className = 'stock-badge absolute top-2 right-2 bg-red-500 text-white text-xs px-2 py-1 rounded-full font-bold';
                            badge.textContent = 'ESGOTADO';
                            productCard.style.position = 'relative';
                            productCard.appendChild(badge);
                        }
                    } else if (product.stock <= 3) {
                        // Add low stock badge
                        if (!productCard.querySelector('.stock-badge')) {
                            const badge = document.createElement('div');
                            badge.className = 'stock-badge absolute top-2 right-2 bg-yellow-500 text-white text-xs px-2 py-1 rounded-full font-bold';
                            badge.textContent = `${product.stock} restantes`;
                            productCard.style.position = 'relative';
                            productCard.appendChild(badge);
                        }
                    }
                }
            });
        }

        // Debounce function for performance
        function debounce(func, wait) {
            let timeout;
            return function executedFunction(...args) {
                const later = () => {
                    clearTimeout(timeout);
                    func(...args);
                };
                clearTimeout(timeout);
                timeout = setTimeout(later, wait);
            };
        }
        
        // Throttle function for scroll events
        function throttle(func, limit) {
            let inThrottle;
            return function() {
                const args = arguments;
                const context = this;
                if (!inThrottle) {
                    func.apply(context, args);
                    inThrottle = true;
                    setTimeout(() => inThrottle = false, limit);
                }
            }
        }
        
        // Advanced Performance & Cache System
        class PerformanceManager {
            constructor() {
                this.cache = new Map();
                this.observers = new Map();
                this.networkInfo = this.getNetworkInfo();
                this.deviceInfo = this.getDeviceInfo();
                this.init();
            }
            
            init() {
                this.setupIntersectionObserver();
                this.setupPerformanceMonitoring();
                this.setupNetworkMonitoring();
                this.setupMemoryManagement();
                this.setupErrorHandling();
            }
            
            getNetworkInfo() {
                if ('connection' in navigator) {
                    const conn = navigator.connection;
                    return {
                        effectiveType: conn.effectiveType,
                        downlink: conn.downlink,
                        rtt: conn.rtt,
                        saveData: conn.saveData
                    };
                }
                return { effectiveType: '4g', saveData: false };
            }
            
            getDeviceInfo() {
                return {
                    isMobile: /Android|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent),
                    isIOS: /iPad|iPhone|iPod/.test(navigator.userAgent),
                    isAndroid: /Android/.test(navigator.userAgent),
                    hasTouch: 'ontouchstart' in window,
                    memory: navigator.deviceMemory || 4,
                    cores: navigator.hardwareConcurrency || 4
                };
            }
            
            setupIntersectionObserver() {
                if ('IntersectionObserver' in window) {
                    const imageObserver = new IntersectionObserver((entries) => {
                        entries.forEach(entry => {
                            if (entry.isIntersecting) {
                                const img = entry.target;
                                if (img.dataset.src) {
                                    img.src = img.dataset.src;
                                    img.classList.add('loaded');
                                    imageObserver.unobserve(img);
                                }
                            }
                        });
                    }, { rootMargin: '50px' });
                    
                    this.observers.set('images', imageObserver);
                }
            }
            
            setupPerformanceMonitoring() {
                if ('PerformanceObserver' in window) {
                    try {
                        const observer = new PerformanceObserver((list) => {
                            list.getEntries().forEach(entry => {
                                if (entry.entryType === 'largest-contentful-paint') {
                                    console.log('LCP:', entry.startTime);
                                }
                                if (entry.entryType === 'first-input') {
                                    console.log('FID:', entry.processingStart - entry.startTime);
                                }
                            });
                        });
                        
                        observer.observe({ entryTypes: ['largest-contentful-paint', 'first-input'] });
                    } catch (e) {
                        console.log('Performance monitoring not supported');
                    }
                }
            }
            
            setupNetworkMonitoring() {
                if ('connection' in navigator) {
                    navigator.connection.addEventListener('change', () => {
                        this.networkInfo = this.getNetworkInfo();
                        this.adaptToNetwork();
                    });
                }
            }
            
            adaptToNetwork() {
                const { effectiveType, saveData } = this.networkInfo;
                
                if (saveData || effectiveType === 'slow-2g' || effectiveType === '2g') {
                    // Disable non-essential animations
                    document.body.classList.add('reduced-motion');
                    // Reduce image quality
                    document.querySelectorAll('img').forEach(img => {
                        if (img.src && !img.dataset.originalSrc) {
                            img.dataset.originalSrc = img.src;
                            // Could implement image compression here
                        }
                    });
                }
            }
            
            setupMemoryManagement() {
                // Clean up unused DOM elements
                setInterval(() => {
                    this.cleanupOffscreenElements();
                }, 30000);
                
                // Monitor memory usage
                if ('memory' in performance) {
                    setInterval(() => {
                        const memInfo = performance.memory;
                        if (memInfo.usedJSHeapSize / memInfo.jsHeapSizeLimit > 0.9) {
                            this.emergencyCleanup();
                        }
                    }, 10000);
                }
            }
            
            cleanupOffscreenElements() {
                document.querySelectorAll('.product-card').forEach(card => {
                    const rect = card.getBoundingClientRect();
                    const isOffscreen = rect.bottom < -200 || rect.top > window.innerHeight + 200;
                    
                    if (isOffscreen) {
                        card.classList.add('offscreen');
                    } else {
                        card.classList.remove('offscreen');
                    }
                });
            }
            
            emergencyCleanup() {
                // Clear caches
                this.cache.clear();
                
                // Remove non-essential elements
                document.querySelectorAll('.below-fold').forEach(el => {
                    if (!el.classList.contains('visible')) {
                        el.style.contentVisibility = 'hidden';
                    }
                });
                
                console.log('Emergency cleanup performed');
            }
            
            setupErrorHandling() {
                window.addEventListener('error', (e) => {
                    console.error('Runtime error:', e.error);
                    // Just log errors, don't show popup or reload
                });
                
                window.addEventListener('unhandledrejection', (e) => {
                    console.error('Unhandled promise rejection:', e.reason);
                    // Just log errors, don't show popup or reload
                });
            }
            
            handleError(error) {
                // Just log the error, don't show popup or auto-reload
                console.error('Error handled:', error);
            }
            
            // Cache management
            setCache(key, value, ttl = 300000) { // 5 minutes default
                this.cache.set(key, {
                    value,
                    expires: Date.now() + ttl
                });
            }
            
            getCache(key) {
                const item = this.cache.get(key);
                if (item && item.expires > Date.now()) {
                    return item.value;
                }
                this.cache.delete(key);
                return null;
            }
        }
        
        // Advanced Image Lazy Loading
        class ImageManager {
            constructor() {
                this.loadedImages = new Set();
                this.failedImages = new Set();
                this.retryCount = new Map();
                this.init();
            }
            
            init() {
                this.setupLazyLoading();
                this.preloadCriticalImages();
            }
            
            setupLazyLoading() {
                if ('IntersectionObserver' in window) {
                    const observer = new IntersectionObserver((entries) => {
                        entries.forEach(entry => {
                            if (entry.isIntersecting) {
                                this.loadImage(entry.target);
                                observer.unobserve(entry.target);
                            }
                        });
                    }, { rootMargin: '100px' });
                    
                    document.querySelectorAll('img[loading="lazy"]').forEach(img => {
                        observer.observe(img);
                    });
                }
            }
            
            loadImage(img) {
                if (this.loadedImages.has(img.src)) return;
                
                const tempImg = new Image();
                tempImg.onload = () => {
                    img.classList.add('loaded');
                    this.loadedImages.add(img.src);
                };
                
                tempImg.onerror = () => {
                    this.handleImageError(img);
                };
                
                tempImg.src = img.src;
            }
            
            handleImageError(img) {
                const retries = this.retryCount.get(img.src) || 0;
                
                if (retries < 2) {
                    // Retry loading
                    this.retryCount.set(img.src, retries + 1);
                    setTimeout(() => this.loadImage(img), 1000 * (retries + 1));
                } else {
                    // Show fallback
                    this.failedImages.add(img.src);
                    const fallback = img.parentElement.querySelector('.no-image');
                    if (fallback) {
                        img.style.display = 'none';
                        fallback.style.display = 'flex';
                    }
                }
            }
            
            preloadCriticalImages() {
                // Preload first few product images
                const criticalImages = document.querySelectorAll('.above-fold img');
                criticalImages.forEach(img => {
                    if (img.src) {
                        const preloadImg = new Image();
                        preloadImg.src = img.src;
                    }
                });
            }
        }
        
        // Initialize systems safely
        let performanceManager, imageManager, validationManager, securityManager, accessibilityManager, analyticsManager;
        
        // Enhanced initialization with error handling
        try {
            updateCartUI();
            updateStockDisplay();
            
            // Initialize advanced systems only if needed
            try {
                validationManager = new ValidationManager();
            } catch (e) {
                console.log('Validation manager not initialized');
            }
            
            // Progressive enhancement
            document.documentElement.classList.remove('no-js');
            
            console.log('App initialized successfully');
            
        } catch (error) {
            console.error('Initialization error:', error);
            // Don't auto-reload, just log the error
        }
        
        // Optimized page load handler
        if (document.readyState === 'loading') {
            document.addEventListener('DOMContentLoaded', initWelcomePopup);
        } else {
            initWelcomePopup();
        }
        
        // Advanced Accessibility Manager
        class AccessibilityManager {
            constructor() {
                this.focusableElements = 'button, [href], input, select, textarea, [tabindex]:not([tabindex="-1"])';
                this.currentModal = null;
                this.previousFocus = null;
                this.init();
            }
            
            init() {
                this.setupKeyboardNavigation();
                this.setupFocusManagement();
                this.setupScreenReaderSupport();
                this.setupHighContrastMode();
                this.setupReducedMotion();
            }
            
            setupKeyboardNavigation() {
                document.addEventListener('keydown', (e) => {
                    // Escape key handling
                    if (e.key === 'Escape') {
                        this.handleEscapeKey();
                    }
                    
                    // Tab navigation in modals
                    if (e.key === 'Tab' && this.currentModal) {
                        this.handleTabNavigation(e);
                    }
                    
                    // Enter/Space for buttons
                    if ((e.key === 'Enter' || e.key === ' ') && e.target.matches('.product-card')) {
                        e.preventDefault();
                        e.target.click();
                    }
                    
                    // Arrow key navigation for categories
                    if (e.key === 'ArrowLeft' || e.key === 'ArrowRight') {
                        this.handleArrowNavigation(e);
                    }
                });
            }
            
            handleEscapeKey() {
                const modals = ['product-modal', 'cart-modal', 'checkout-modal', 'welcome-popup'];
                modals.forEach(modalId => {
                    const modal = document.getElementById(modalId);
                    if (modal && !modal.classList.contains('hidden')) {
                        if (modalId === 'product-modal') closeProductModal();
                        else if (modalId === 'cart-modal') closeCart();
                        else if (modalId === 'checkout-modal') closeCheckout();
                        else if (modalId === 'welcome-popup') closeWelcomePopup();
                    }
                });
            }
            
            handleTabNavigation(e) {
                const focusableElements = this.currentModal.querySelectorAll(this.focusableElements);
                const firstElement = focusableElements[0];
                const lastElement = focusableElements[focusableElements.length - 1];
                
                if (e.shiftKey) {
                    if (document.activeElement === firstElement) {
                        e.preventDefault();
                        lastElement.focus();
                    }
                } else {
                    if (document.activeElement === lastElement) {
                        e.preventDefault();
                        firstElement.focus();
                    }
                }
            }
            
            handleArrowNavigation(e) {
                const categoryButtons = document.querySelectorAll('.category-btn');
                const currentIndex = Array.from(categoryButtons).findIndex(btn => btn === document.activeElement);
                
                if (currentIndex !== -1) {
                    e.preventDefault();
                    let nextIndex;
                    
                    if (e.key === 'ArrowLeft') {
                        nextIndex = currentIndex > 0 ? currentIndex - 1 : categoryButtons.length - 1;
                    } else {
                        nextIndex = currentIndex < categoryButtons.length - 1 ? currentIndex + 1 : 0;
                    }
                    
                    categoryButtons[nextIndex].focus();
                }
            }
            
            setupFocusManagement() {
                // Store focus when opening modals
                const originalOpenProductModal = window.openProductModal;
                window.openProductModal = (productId) => {
                    this.previousFocus = document.activeElement;
                    originalOpenProductModal(productId);
                    this.currentModal = document.getElementById('product-modal');
                    
                    // Focus first focusable element
                    setTimeout(() => {
                        const firstFocusable = this.currentModal.querySelector(this.focusableElements);
                        if (firstFocusable) firstFocusable.focus();
                    }, 100);
                };
                
                // Restore focus when closing modals
                const originalCloseProductModal = window.closeProductModal;
                window.closeProductModal = (event) => {
                    originalCloseProductModal(event);
                    this.currentModal = null;
                    if (this.previousFocus) {
                        this.previousFocus.focus();
                        this.previousFocus = null;
                    }
                };
            }
            
            setupScreenReaderSupport() {
                // Add ARIA labels and descriptions
                document.querySelectorAll('.product-card').forEach((card, index) => {
                    card.setAttribute('role', 'button');
                    card.setAttribute('aria-label', `Produto ${index + 1}`);
                    card.setAttribute('tabindex', '0');
                });
                
                // Live region for notifications
                const liveRegion = document.createElement('div');
                liveRegion.setAttribute('aria-live', 'polite');
                liveRegion.setAttribute('aria-atomic', 'true');
                liveRegion.className = 'sr-only';
                liveRegion.id = 'live-region';
                document.body.appendChild(liveRegion);
                
                // Announce cart updates
                const originalUpdateCartUI = window.updateCartUI;
                window.updateCartUI = () => {
                    originalUpdateCartUI();
                    const cartCount = cart.reduce((sum, item) => sum + item.quantity, 0);
                    liveRegion.textContent = `Carrinho atualizado. ${cartCount} itens no carrinho.`;
                };
            }
            
            setupHighContrastMode() {
                // Detect high contrast preference
                if (window.matchMedia('(prefers-contrast: high)').matches) {
                    document.body.classList.add('high-contrast');
                }
                
                // Listen for changes
                window.matchMedia('(prefers-contrast: high)').addEventListener('change', (e) => {
                    if (e.matches) {
                        document.body.classList.add('high-contrast');
                    } else {
                        document.body.classList.remove('high-contrast');
                    }
                });
            }
            
            setupReducedMotion() {
                // Detect reduced motion preference
                if (window.matchMedia('(prefers-reduced-motion: reduce)').matches) {
                    document.body.classList.add('reduced-motion');
                }
                
                // Listen for changes
                window.matchMedia('(prefers-reduced-motion: reduce)').addEventListener('change', (e) => {
                    if (e.matches) {
                        document.body.classList.add('reduced-motion');
                    } else {
                        document.body.classList.remove('reduced-motion');
                    }
                });
            }
            
            announceToScreenReader(message) {
                const liveRegion = document.getElementById('live-region');
                if (liveRegion) {
                    liveRegion.textContent = message;
                }
            }
        }
        
        // Enhanced Analytics & Monitoring
        class AnalyticsManager {
            constructor() {
                this.events = [];
                this.sessionStart = Date.now();
                this.init();
            }
            
            init() {
                this.setupEventTracking();
                this.setupPerformanceTracking();
                this.setupErrorTracking();
                this.setupUserBehaviorTracking();
            }
            
            setupEventTracking() {
                // Track product views
                const originalOpenProductModal = window.openProductModal;
                window.openProductModal = (productId) => {
                    this.trackEvent('product_view', { productId });
                    originalOpenProductModal(productId);
                };
                
                // Track cart additions
                const originalAddToCart = window.addToCart;
                window.addToCart = () => {
                    this.trackEvent('add_to_cart', { 
                        productId: Object.keys(products).find(key => products[key] === currentProduct),
                        quantity: quantity 
                    });
                    originalAddToCart();
                };
                
                // Track order attempts
                const originalSendOrder = window.sendOrder;
                window.sendOrder = () => {
                    this.trackEvent('order_attempt', { 
                        cartValue: cart.reduce((sum, item) => sum + item.totalPrice, 0),
                        itemCount: cart.length 
                    });
                    originalSendOrder();
                };
            }
            
            setupPerformanceTracking() {
                // Track page load time
                window.addEventListener('load', () => {
                    const loadTime = performance.now();
                    this.trackEvent('page_load', { loadTime });
                });
                
                // Track interaction delays
                document.addEventListener('click', (e) => {
                    const start = performance.now();
                    requestAnimationFrame(() => {
                        const delay = performance.now() - start;
                        if (delay > 100) {
                            this.trackEvent('slow_interaction', { delay, element: e.target.tagName });
                        }
                    });
                });
            }
            
            setupErrorTracking() {
                window.addEventListener('error', (e) => {
                    this.trackEvent('javascript_error', {
                        message: e.message,
                        filename: e.filename,
                        lineno: e.lineno
                    });
                });
            }
            
            setupUserBehaviorTracking() {
                // Track scroll depth
                let maxScroll = 0;
                window.addEventListener('scroll', throttle(() => {
                    const scrollPercent = Math.round((window.scrollY / (document.body.scrollHeight - window.innerHeight)) * 100);
                    if (scrollPercent > maxScroll) {
                        maxScroll = scrollPercent;
                        this.trackEvent('scroll_depth', { depth: scrollPercent });
                    }
                }, 1000));
                
                // Track time on page
                setInterval(() => {
                    const timeOnPage = Date.now() - this.sessionStart;
                    this.trackEvent('time_on_page', { duration: timeOnPage });
                }, 30000);
            }
            
            trackEvent(eventName, data = {}) {
                const event = {
                    name: eventName,
                    timestamp: Date.now(),
                    data: data,
                    userAgent: navigator.userAgent,
                    url: window.location.href
                };
                
                this.events.push(event);
                console.log('Analytics Event:', event);
                
                // In a real app, you would send this to your analytics service
                // this.sendToAnalytics(event);
            }
            
            getSessionSummary() {
                return {
                    sessionDuration: Date.now() - this.sessionStart,
                    eventCount: this.events.length,
                    events: this.events
                };
            }
        }
        
        // Add keyboard navigation and accessibility
        document.addEventListener('keydown', function(e) {
            // This is now handled by AccessibilityManager
        });
        
        // Prevent zoom on double tap (iOS Safari)
        let lastTouchEnd = 0;
        document.addEventListener('touchend', function (event) {
            const now = (new Date()).getTime();
            if (now - lastTouchEnd <= 300) {
                event.preventDefault();
            }
            lastTouchEnd = now;
        }, false);

        // Checkout event listeners
        document.addEventListener('DOMContentLoaded', function() {
            // Delivery type change
            document.querySelectorAll('input[name="delivery-type"]').forEach(radio => {
                radio.addEventListener('change', function() {
                    // Update visual selection
                    document.querySelectorAll('.delivery-option').forEach(option => {
                        option.classList.remove('border-brand-red', 'bg-brand-red/5');
                        option.classList.add('border-gray-200');
                    });
                    
                    const selectedOption = this.closest('.delivery-option');
                    selectedOption.classList.remove('border-gray-200');
                    selectedOption.classList.add('border-brand-red', 'bg-brand-red/5');
                    
                    // Show/hide address section
                    const addressSection = document.getElementById('address-section');
                    if (this.value === 'delivery') {
                        addressSection.classList.remove('hidden');
                    } else {
                        addressSection.classList.add('hidden');
                    }
                });
            });

            // Payment method change
            document.querySelectorAll('input[name="payment-method"]').forEach(radio => {
                radio.addEventListener('change', function() {
                    // Update visual selection
                    document.querySelectorAll('.payment-option').forEach(option => {
                        option.classList.remove('border-brand-red', 'bg-brand-red/5');
                        option.classList.add('border-gray-200');
                    });
                    
                    const selectedOption = this.closest('.payment-option');
                    selectedOption.classList.remove('border-gray-200');
                    selectedOption.classList.add('border-brand-red', 'bg-brand-red/5');
                    
                    // Show/hide change section with animation
                    const changeSection = document.getElementById('change-section');
                    const changeTitle = document.getElementById('change-title');
                    
                    if (this.value === 'money') {
                        changeSection.classList.remove('hidden');
                        // Adicionar anima√ß√£o de aten√ß√£o no t√≠tulo
                        setTimeout(() => {
                            changeTitle.classList.add('attention-pulse');
                            setTimeout(() => {
                                changeTitle.classList.remove('attention-pulse');
                            }, 4500); // 3 pulsos de 1.5s cada
                        }, 100);
                    } else {
                        changeSection.classList.add('hidden');
                        changeTitle.classList.remove('attention-pulse');
                    }
                });
            });

            // Money amount change
            document.getElementById('money-amount').addEventListener('input', function() {
                const subtotal = cart.reduce((sum, item) => sum + item.totalPrice, 0);
                const discountInfo = calculateDiscount(subtotal);
                const serviceFee = 0.30;
                const finalTotal = subtotal + serviceFee - discountInfo.discount;
                const moneyAmount = parseFloat(this.value);
                const changeAmountEl = document.getElementById('change-amount');
                
                if (moneyAmount && moneyAmount >= finalTotal) {
                    const change = moneyAmount - finalTotal;
                    changeAmountEl.textContent = `Troco: R$ ${change.toFixed(2).replace('.', ',')}`;
                    changeAmountEl.className = 'text-sm text-green-600 mt-2';
                } else if (moneyAmount) {
                    changeAmountEl.textContent = 'Valor insuficiente';
                    changeAmountEl.className = 'text-sm text-red-600 mt-2';
                } else {
                    changeAmountEl.textContent = '';
                }
            });

            // Crossell option styling
            document.addEventListener('change', function(e) {
                if (e.target.classList.contains('crossell')) {
                    // Remove selected styling from all options in the same group
                    const groupName = e.target.name;
                    document.querySelectorAll(`input[name="${groupName}"]`).forEach(input => {
                        const option = input.closest('.crossell-option');
                        if (option) {
                            option.classList.remove('border-brand-red', 'bg-brand-red/5');
                            option.classList.add('border-gray-200');
                        }
                    });
                    
                    // Add selected styling to current option
                    const selectedOption = e.target.closest('.crossell-option');
                    if (selectedOption && e.target.checked) {
                        selectedOption.classList.remove('border-gray-200');
                        selectedOption.classList.add('border-brand-red', 'bg-brand-red/5');
                    }
                }
            });
        });
    </script>
<script>(function(){function c(){var b=a.contentDocument||a.contentWindow.document;if(b){var d=b.createElement('script');d.innerHTML="window.__CF$cv$params={r:'97c1e6f5c651e10b',t:'MTc1NzM3MDc1MC4wMDAwMDA='};var a=document.createElement('script');a.nonce='';a.src='/cdn-cgi/challenge-platform/scripts/jsd/main.js';document.getElementsByTagName('head')[0].appendChild(a);";b.getElementsByTagName('head')[0].appendChild(d)}}if(document.body){var a=document.createElement('iframe');a.height=1;a.width=1;a.style.position='absolute';a.style.top=0;a.style.left=0;a.style.border='none';a.style.visibility='hidden';document.body.appendChild(a);if('loading'!==document.readyState)c();else if(window.addEventListener)document.addEventListener('DOMContentLoaded',c);else{var e=document.onreadystatechange||function(){};document.onreadystatechange=function(b){e(b);'loading'!==document.readyState&&(document.onreadystatechange=e,c())}}}})();</script></body>
</html>


